import pandas as pd
import numpy as np
import os
import datetime

def unstack_data(df):
    rows = []
    rfids = [i for i in df.rfid.unique()]

    for rfid in rfids:
        temp = df[df.rfid==rfid]
        temp = temp.reset_index(drop=True)
        temp.sort_values(['trial_id'],inplace=True)
        temp.set_index('trial_id',inplace=True)
        temp_row = temp.iloc[:,1:].unstack().to_frame().sort_index(level=1).T
        temp_row.insert(loc=0, column='rfid', value=temp.rfid.unique())
        temp_row = temp_row.reset_index(drop=True)
        rows.append(temp_row)
        
    return rows


def deserialize_data(ts):
    if pd.isnull(ts):
        return []
    return [float(i) for i in ts.split()]


sub = pd.read_csv('/dbfs/mnt/testmount/tables/subject.csv')
#rfid is the primary key

mmt = pd.read_csv('/dbfs/mnt/testmount/tables/measurement.csv')
#rfid, measurement_name, measure_number is the unique key


mmt['measure_id'] = mmt['measurement_name'] + ['_']*len(mmt) + mmt['measure_number'].astype(str)
mmt_trimmed = mmt.drop(columns=['measurement_name','drug_group','cohort','measure_number','date_measured'])

rows = []
#get unique rfids
rfids = [i for i in mmt.rfid.unique()]

for rfid in rfids:
    temp = mmt_trimmed[mmt_trimmed.rfid == rfid]
    temp = temp.reset_index(drop=True)
    temp.sort_values(['measure_id'],inplace=True)
    temp.set_index('measure_id',inplace=True)
    temp_row = temp.iloc[:,1:].unstack().to_frame().sort_index(level=1).T
    temp_row.insert(loc=0, column='rfid', value=temp.rfid.unique())
    temp_row = temp_row.reset_index(drop=True)
    rows.append(temp_row)

mmt_unstacked = pd.concat(rows,ignore_index=True)
temp_cols = []
for i in mmt_unstacked.columns:
    if 'rfid' in i:
        temp_cols.append('rfid')
    else:
        temp_cols.append(i[0]+'_'+i[1])
#mmt_unstacked.columns = ['rfid'] + [i[0]+'_'+i[1] for i in mmt_unstacked.columns[1:]]
mmt_unstacked.columns = temp_cols


irr = pd.read_csv('/dbfs/mnt/testmount/tables/irritability.csv')

irr_trimmed = irr.drop(columns=['subject', 'cohort', 'sex', 'exp_group'])


ti = pd.read_csv('/dbfs/mnt/testmount/tables/tail_immersion.csv')
#rfid is the primary key

ti_trimmed = ti.drop(columns=['subject', 'cohort', 'sex', 'drug','tail_immersion_1_date', 'tail_immersion_2_date','tail_immersion_3_date','experiment_group'])

vf = pd.read_csv('/dbfs/mnt/testmount/tables/von_frey.csv')

vf_trimmed = vf.drop(columns=['subject', 'cohort', 'sex', 'drug','von_frey_1_date', 'von_frey_2_date','experiment_group'])
print(vf_trimmed.shape)
vf_trimmed.head()

note = pd.read_csv('/dbfs/mnt/testmount/tables/trial_note.csv')

note['drug'] = note['drug'].str.lower()
note['to_do'] = note['to_do'].apply(lambda x: str(x).lower().strip())
note_filter = note[note['to_do']=='discard'][['rfid','trial_id','drug','to_do']]
note_filter.reset_index(drop=True,inplace=True)

note_filter.replace('SHOCK','SHOCK_V3',inplace=True)
note_filter.replace('PRE-SHOCK','PRESHOCK',inplace=True)
note_filter.replace('TREAMENT02','TREATMENT02',inplace=True)
note_filter.replace('TREAMENT03','TREATMENT03',inplace=True)
note_filter.replace('PRE-SHOCK','PRESHOCK',inplace=True)


shock = pd.read_csv('/dbfs/mnt/testmount/tables/trial_shock.csv')
#pimarykey is rfid,trial id, drug


shock['rewards_got_shock'] = shock['rewards_got_shock'].apply(deserialize_data)
shock['reward_timestamps'] = shock['reward_timestamps'].apply(deserialize_data)
shock_trimmed = shock.drop(columns=['subject', 'room', 'cohort', 'box','start_date','end_date'])

shock_keep = pd.merge(shock_trimmed, note_filter, how='left', left_on=['rfid','trial_id','drug'], right_on=['rfid','trial_id','drug'])
shock_keep = shock_keep[~(shock_keep['to_do']=='discard')]
shock_keep.drop(columns=['drug','to_do'],inplace=True)
shock_keep

# COMMAND ----------

rows = unstack_data(shock_keep)
shock_unstacked = pd.concat(rows,ignore_index=True)
shock_unstacked.columns = [i[0]+'_'+i[1] if (i[0] != 'rfid') else i[0] for i in shock_unstacked.columns]
print(shock_unstacked.shape)
shock_unstacked.head()

# COMMAND ----------

ori_cols = list(shock_unstacked.columns)
ori_cols.remove('rfid')
new_cols = ['rfid'] + ori_cols
shock_unstacked = shock_unstacked[new_cols]
shock_unstacked.head()

pr = pd.read_csv('/dbfs/mnt/testmount/tables/trial_pr.csv')
#pimarykey is rfid,trial id, drug


pr['ratios'] = pr['ratios'].apply(deserialize_data)
pr_trimmed = pr.drop(columns=['subject', 'room', 'cohort', 'box','start_date','end_date'])

pr_keep = pd.merge(pr_trimmed, note_filter, how='left', left_on=['rfid','trial_id','drug'], right_on=['rfid','trial_id','drug'])
pr_keep = pr_keep[~(pr_keep['to_do']=='discard')]


rows = unstack_data(pr_keep)
pr_unstacked = pd.concat(rows,ignore_index=True)
pr_unstacked.columns = [i[0]+'_'+i[1] if (i[0] != 'rfid') else i[0] for i in pr_unstacked.columns]


ori_cols = list(pr_unstacked.columns)
ori_cols.remove('rfid')
new_cols = ['rfid'] + ori_cols

# MAGIC %md
# MAGIC ## Trial SHA

# COMMAND ----------

sha = pd.read_csv('/dbfs/mnt/testmount/tables/trial_sha.csv')


# COMMAND ----------

sha['active_timestamps'] = sha['active_timestamps'].apply(deserialize_data)
sha['inactive_timestamps'] = sha['inactive_timestamps'].apply(deserialize_data)
sha['reward_timestamps'] = sha['reward_timestamps'].apply(deserialize_data)
sha['timeout_timestamps'] = sha['timeout_timestamps'].apply(deserialize_data)

sha_trimmed = sha.drop(columns=['subject', 'room', 'cohort', 'box','start_date','end_date'])

# COMMAND ----------

sha_keep = pd.merge(sha_trimmed, note_filter, how='left', left_on=['rfid','trial_id','drug'], right_on=['rfid','trial_id','drug'])
sha_keep = sha_keep[~(sha_keep['to_do']=='discard')]
sha_keep.drop(columns=['drug','to_do'],inplace=True)


rows = unstack_data(sha_keep)
sha_unstacked = pd.concat(rows,ignore_index=True)
sha_unstacked.columns = [i[0]+'_'+i[1] if (i[0] != 'rfid') else i[0] for i in sha_unstacked.columns]


ori_cols = list(sha_unstacked.columns)
ori_cols.remove('rfid')
new_cols = ['rfid'] + ori_cols
sha_unstacked = sha_unstacked[new_cols]

lga = pd.read_csv('/dbfs/mnt/testmount/tables/trial_lga.csv')
#pimarykey is rfid,trial id, drug
lga['timeout_presses'] = lga['active_lever_presses'] - lga['reward_presses']


lga['active_timestamps'] = lga['active_timestamps'].apply(deserialize_data)
lga['inactive_timestamps'] = lga['inactive_timestamps'].apply(deserialize_data)
lga['reward_timestamps'] = lga['reward_timestamps'].apply(deserialize_data)
lga['timeout_timestamps'] = lga['timeout_timestamps'].apply(deserialize_data)

lga_trimmed = lga.drop(columns=['subject', 'room', 'cohort', 'box','start_date','end_date'])


lga_keep = pd.merge(lga_trimmed, note_filter, how='left', left_on=['rfid','trial_id','drug'], right_on=['rfid','trial_id','drug'])
lga_keep = lga_keep[~(lga_keep['to_do']=='discard')]
lga_keep.drop(columns=['drug','to_do'],inplace=True)
lga_keep.head()


rows = unstack_data(lga_keep)
lga_unstacked = pd.concat(rows,ignore_index=True)
lga_unstacked.columns = [i[0]+'_'+i[1] if (i[0] != 'rfid') else i[0] for i in lga_unstacked.columns]

ori_cols = list(lga_unstacked.columns)
ori_cols.remove('rfid')
new_cols = ['rfid'] + ori_cols
lga_unstacked = lga_unstacked[new_cols]

for i in sub.columns:
    if 'd' in i.lower():
        #print(i)
        i
sub['drug_group'].unique()


test = (
    sub.merge(mmt_unstacked, how='left', on='rfid')
        .merge(irr_trimmed, how='left', on='rfid')
        .merge(ti_trimmed, how='left', on='rfid')
        .merge(vf_trimmed, how='left', on='rfid')
        .merge(shock_unstacked, how='left', on='rfid')
        .merge(pr_unstacked, how='left', on='rfid')
        .merge(sha_unstacked, how='left', on='rfid')
        .merge(lga_unstacked, how='left', on='rfid')
)
test

# COMMAND ----------

ordered_cols = [
    'rfid',
    'rat',
    'cohort',
    'sex',
    'drug_group',
    'experiment_group',
    'dissection_group',
    'brevital',
    'last_good_session',
    'exit_code',
    'complete',
    'tissue_collected', 
    'exit_notes',
    'replaced_by',
    'decision',
    'coat_color',
    'ear_punch',
    'litter_number',
    'litter_size',
    'rack',
    'shipping_box',
    'uv',
    'female_swab_1_analysis',
    'female_swab_2_analysis',
    'female_swab_3_analysis',
    'reward_presses_SHA01',
    'reward_presses_SHA02',
    'reward_presses_SHA03',
    'reward_presses_SHA04',
    'reward_presses_SHA05',
    'reward_presses_SHA06',
    'reward_presses_SHA07',
    'reward_presses_SHA08',
    'reward_presses_SHA09',
    'reward_presses_SHA10',
    'active_lever_presses_SHA01',
    'active_lever_presses_SHA02',
    'active_lever_presses_SHA03',
    'active_lever_presses_SHA04',
    'active_lever_presses_SHA05',
    'active_lever_presses_SHA06',
    'active_lever_presses_SHA07',
    'active_lever_presses_SHA08',
    'active_lever_presses_SHA09',
    'active_lever_presses_SHA10',
    'timeout_presses_SHA01',
    'timeout_presses_SHA02', 
    'timeout_presses_SHA03',
    'timeout_presses_SHA04',
    'timeout_presses_SHA05',
    'timeout_presses_SHA06',
    'timeout_presses_SHA07',
    'timeout_presses_SHA08',
    'timeout_presses_SHA09',
    'timeout_presses_SHA10',
    'inactive_lever_presses_SHA01',
    'inactive_lever_presses_SHA02',
    'inactive_lever_presses_SHA03',
    'inactive_lever_presses_SHA04',
    'inactive_lever_presses_SHA05',
    'inactive_lever_presses_SHA06',
    'inactive_lever_presses_SHA07',
    'inactive_lever_presses_SHA08',
    'inactive_lever_presses_SHA09',
    'inactive_lever_presses_SHA10',
    'reward_presses_LGA01',
    'reward_presses_LGA02',
    'reward_presses_LGA03',
    'reward_presses_LGA04',
    'reward_presses_LGA05',
    'reward_presses_LGA06',
    'reward_presses_LGA07',
    'reward_presses_LGA08',
    'reward_presses_LGA09',
    'reward_presses_LGA10',
    'reward_presses_LGA11',
    'reward_presses_LGA12',
    'reward_presses_LGA13',
    'reward_presses_LGA14',
    'active_lever_presses_LGA01',
    'active_lever_presses_LGA02',
    'active_lever_presses_LGA03',
    'active_lever_presses_LGA04',
    'active_lever_presses_LGA05',
    'active_lever_presses_LGA06',
    'active_lever_presses_LGA07',
    'active_lever_presses_LGA08',
    'active_lever_presses_LGA09',
    'active_lever_presses_LGA10',
    'active_lever_presses_LGA11',
    'active_lever_presses_LGA12',
    'active_lever_presses_LGA13',
    'active_lever_presses_LGA14',
    'timeout_presses_LGA01',
    'timeout_presses_LGA02',
    'timeout_presses_LGA03',
    'timeout_presses_LGA04',
    'timeout_presses_LGA05',
    'timeout_presses_LGA06',
    'timeout_presses_LGA07',
    'timeout_presses_LGA08',
    'timeout_presses_LGA09',
    'timeout_presses_LGA10',
    'timeout_presses_LGA11',
    'timeout_presses_LGA12',
    'timeout_presses_LGA13',
    'timeout_presses_LGA14',
    'inactive_lever_presses_LGA01',
    'inactive_lever_presses_LGA02',
    'inactive_lever_presses_LGA03',
    'inactive_lever_presses_LGA04',
    'inactive_lever_presses_LGA05',
    'inactive_lever_presses_LGA06',
    'inactive_lever_presses_LGA07',
    'inactive_lever_presses_LGA08',
    'inactive_lever_presses_LGA09',
    'inactive_lever_presses_LGA10',
    'inactive_lever_presses_LGA11',
    'inactive_lever_presses_LGA12',
    'inactive_lever_presses_LGA13',
    'inactive_lever_presses_LGA14',
    'reward_presses_PR01',
    'reward_presses_PR02',
    'reward_presses_PR03',
    'active_lever_presses_PR01',
    'active_lever_presses_PR02',
    'active_lever_presses_PR03',
    'inactive_lever_presses_PR01',
    'inactive_lever_presses_PR02',
    'inactive_lever_presses_PR03',
    'breakpoint_PR01',
    'breakpoint_PR02',
    'breakpoint_PR03',
    'last_ratio_PR01',
    'last_ratio_PR02',
    'last_ratio_PR03',
    'treatment_1_group',
    'treatment_2_group',
    'treatment_3_group',
    'treatment_4_group',
    'reward_presses_TREATMENT01',
    'reward_presses_TREATMENT02',
    'reward_presses_TREATMENT03',
    'reward_presses_TREATMENT04',
    'active_lever_presses_TREATMENT01',
    'active_lever_presses_TREATMENT02',
    'active_lever_presses_TREATMENT03',
    'active_lever_presses_TREATMENT04',
    'inactive_lever_presses_TREATMENT01',
    'inactive_lever_presses_TREATMENT02',
    'inactive_lever_presses_TREATMENT03',
    'inactive_lever_presses_TREATMENT04',
    'breakpoint_TREATMENT01',
    'breakpoint_TREATMENT02',
    'breakpoint_TREATMENT03',
    'breakpoint_TREATMENT04',
    'last_ratio_TREATMENT01',
    'last_ratio_TREATMENT02',
    'last_ratio_TREATMENT03',
    'last_ratio_TREATMENT04',
    'total_reward_PRESHOCK',
    'total_reward_SHOCK_V1',
    'total_reward_SHOCK_V2',
    'total_reward_SHOCK_V3',
    'total_active_lever_presses_PRESHOCK',
    'total_active_lever_presses_SHOCK_V1',
    'total_active_lever_presses_SHOCK_V2',
    'total_active_lever_presses_SHOCK_V3',
    'total_inactive_lever_presses_PRESHOCK',
    'total_inactive_lever_presses_SHOCK_V1',
    'total_inactive_lever_presses_SHOCK_V2',
    'total_inactive_lever_presses_SHOCK_V3',
    'total_shocks_PRESHOCK',
    'total_shocks_SHOCK_V1',
    'total_shocks_SHOCK_V2',
    'total_shocks_SHOCK_V3',
    'rewards_after_first_shock_PRESHOCK',
    'rewards_after_first_shock_SHOCK_V1',
    'rewards_after_first_shock_SHOCK_V2',
    'rewards_after_first_shock_SHOCK_V3',
    'reward_presses_SHA11',
    'active_lever_presses_SHA11',
    'timeout_presses_SHA11',
    'inactive_lever_presses_SHA11',
    'reward_presses_LGA15',
    'reward_presses_LGA16',
    'reward_presses_LGA17',
    'reward_presses_LGA18',
    'reward_presses_LGA19',
    'reward_presses_LGA20',
    'reward_presses_LGA21',
    'reward_presses_LGA22',
    'reward_presses_LGA23',
    'reward_presses_LGA24',
    'reward_presses_LGA25',
    'reward_presses_LGA26',
    'reward_presses_LGA27',
    'reward_presses_LGA28',
    'active_lever_presses_LGA15',
    'active_lever_presses_LGA16',
    'active_lever_presses_LGA17',
    'active_lever_presses_LGA18',
    'active_lever_presses_LGA19',
    'active_lever_presses_LGA20',
    'active_lever_presses_LGA21',
    'active_lever_presses_LGA22',
    'active_lever_presses_LGA23',
    'active_lever_presses_LGA24',
    'active_lever_presses_LGA25',
    'active_lever_presses_LGA26',
    'active_lever_presses_LGA27',
    'active_lever_presses_LGA28',
    'timeout_presses_LGA15',
    'timeout_presses_LGA16',
    'timeout_presses_LGA17',
    'timeout_presses_LGA18',
    'timeout_presses_LGA19',
    'timeout_presses_LGA20',
    'timeout_presses_LGA21',
    'timeout_presses_LGA22',
    'timeout_presses_LGA23',
    'timeout_presses_LGA24',
    'timeout_presses_LGA25',
    'timeout_presses_LGA26',
    'timeout_presses_LGA27',
    'timeout_presses_LGA28',
    'inactive_lever_presses_LGA15',
    'inactive_lever_presses_LGA16',
    'inactive_lever_presses_LGA17',
    'inactive_lever_presses_LGA18',
    'inactive_lever_presses_LGA19',
    'inactive_lever_presses_LGA20',
    'inactive_lever_presses_LGA21',
    'inactive_lever_presses_LGA22',
    'inactive_lever_presses_LGA23',
    'inactive_lever_presses_LGA24',
    'inactive_lever_presses_LGA25',
    'inactive_lever_presses_LGA26',
    'inactive_lever_presses_LGA27',
    'inactive_lever_presses_LGA28',
    'von_frey_1_force',
    'von_frey_1_time',
    'von_frey_2_force',
    'von_frey_2_time',
    'von_frey_difference_force',
    'tail_immersion_1_time',
    'tail_immersion_2_time',
    'tail_immersion_3_time',
    'tail_immersion_difference_tolerance',
    'def_bsl_ave',
    'agg_bsl_ave',
    'total_bsl_ave',
    'def_drug_ave',
    'agg_drug_ave',
    'total_drug_ave',
    'diff_ave_def',
    'diff_ave_agg',
    'diff_ave_total',
    'reward_timestamps_SHA01',
    'reward_timestamps_SHA02',
    'reward_timestamps_SHA03',
    'reward_timestamps_SHA04',
    'reward_timestamps_SHA05',
    'reward_timestamps_SHA06',
    'reward_timestamps_SHA07',
    'reward_timestamps_SHA08',
    'reward_timestamps_SHA09',
    'reward_timestamps_SHA10',
    'active_timestamps_SHA01',
    'active_timestamps_SHA02',
    'active_timestamps_SHA03',
    'active_timestamps_SHA04',
    'active_timestamps_SHA05',
    'active_timestamps_SHA06',
    'active_timestamps_SHA07',
    'active_timestamps_SHA08',
    'active_timestamps_SHA09',
    'active_timestamps_SHA10',
    'timeout_timestamps_SHA01',
    'timeout_timestamps_SHA02',
    'timeout_timestamps_SHA03',
    'timeout_timestamps_SHA04',
    'timeout_timestamps_SHA05',
    'timeout_timestamps_SHA06',
    'timeout_timestamps_SHA07',
    'timeout_timestamps_SHA08',
    'timeout_timestamps_SHA09',
    'timeout_timestamps_SHA10',
    'inactive_timestamps_SHA01',
    'inactive_timestamps_SHA02',
    'inactive_timestamps_SHA03',
    'inactive_timestamps_SHA04',
    'inactive_timestamps_SHA05',
    'inactive_timestamps_SHA06',
    'inactive_timestamps_SHA07',
    'inactive_timestamps_SHA08',
    'inactive_timestamps_SHA09',
    'inactive_timestamps_SHA10',
    'reward_timestamps_LGA01',
    'reward_timestamps_LGA02',
    'reward_timestamps_LGA03',
    'reward_timestamps_LGA04',
    'reward_timestamps_LGA05',
    'reward_timestamps_LGA06',
    'reward_timestamps_LGA07',
    'reward_timestamps_LGA08',
    'reward_timestamps_LGA09',
    'reward_timestamps_LGA10',
    'reward_timestamps_LGA11',
    'reward_timestamps_LGA12',
    'reward_timestamps_LGA13',
    'reward_timestamps_LGA14',
    'active_timestamps_LGA01',
    'active_timestamps_LGA02',
    'active_timestamps_LGA03',
    'active_timestamps_LGA04',
    'active_timestamps_LGA05',
    'active_timestamps_LGA06',
    'active_timestamps_LGA07',
    'active_timestamps_LGA08',
    'active_timestamps_LGA09',
    'active_timestamps_LGA10',
    'active_timestamps_LGA11',
    'active_timestamps_LGA12',
    'active_timestamps_LGA13',
    'active_timestamps_LGA14',
    'timeout_timestamps_LGA01',
    'timeout_timestamps_LGA02',
    'timeout_timestamps_LGA03',
    'timeout_timestamps_LGA04',
    'timeout_timestamps_LGA05',
    'timeout_timestamps_LGA06',
    'timeout_timestamps_LGA07',
    'timeout_timestamps_LGA08',
    'timeout_timestamps_LGA09',
    'timeout_timestamps_LGA10',
    'timeout_timestamps_LGA11',
    'timeout_timestamps_LGA12',
    'timeout_timestamps_LGA13',
    'timeout_timestamps_LGA14',
    'inactive_timestamps_LGA01',
    'inactive_timestamps_LGA02',
    'inactive_timestamps_LGA03',
    'inactive_timestamps_LGA04',
    'inactive_timestamps_LGA05',
    'inactive_timestamps_LGA06',
    'inactive_timestamps_LGA07',
    'inactive_timestamps_LGA08',
    'inactive_timestamps_LGA09',
    'inactive_timestamps_LGA10',
    'inactive_timestamps_LGA11',
    'inactive_timestamps_LGA12',
    'inactive_timestamps_LGA13',
    'inactive_timestamps_LGA14',
    'ratios_PR01',
    'ratios_PR02',
    'ratios_PR03',
    'ratios_TREATMENT01',
    'ratios_TREATMENT02',
    'ratios_TREATMENT03',
    'ratios_TREATMENT04',
    'group_pre_shock',
    'group_shock',
    'rewards_got_shock_PRESHOCK',
    'rewards_got_shock_SHOCK_V1',
    'rewards_got_shock_SHOCK_V2',
    'rewards_got_shock_SHOCK_V3',
    'reward_timestamps_PRESHOCK',
    'reward_timestamps_SHOCK_V1',
    'reward_timestamps_SHOCK_V2',
    'reward_timestamps_SHOCK_V3',
    'reward_timestamps_SHA11',
    'active_timestamps_SHA11',
    'timeout_timestamps_SHA11',
    'inactive_timestamps_SHA11',
    'reward_timestamps_LGA15',
    'reward_timestamps_LGA16',
    'reward_timestamps_LGA17',
    'reward_timestamps_LGA18',
    'reward_timestamps_LGA19',
    'reward_timestamps_LGA20',
    'reward_timestamps_LGA21',
    'reward_timestamps_LGA22',
    'reward_timestamps_LGA23',
    'reward_timestamps_LGA24',
    'reward_timestamps_LGA25',
    'reward_timestamps_LGA26',
    'reward_timestamps_LGA27',
    'reward_timestamps_LGA28',
    'active_timestamps_LGA15',
    'active_timestamps_LGA16',
    'active_timestamps_LGA17',
    'active_timestamps_LGA18',
    'active_timestamps_LGA19',
    'active_timestamps_LGA20',
    'active_timestamps_LGA21',
    'active_timestamps_LGA22',
    'active_timestamps_LGA23',
    'active_timestamps_LGA24',
    'active_timestamps_LGA25',
    'active_timestamps_LGA26',
    'active_timestamps_LGA27',
    'active_timestamps_LGA28',
    'timeout_timestamps_LGA15',
    'timeout_timestamps_LGA16',
    'timeout_timestamps_LGA17',
    'timeout_timestamps_LGA18',
    'timeout_timestamps_LGA19',
    'timeout_timestamps_LGA20',
    'timeout_timestamps_LGA21',
    'timeout_timestamps_LGA22',
    'timeout_timestamps_LGA23',
    'timeout_timestamps_LGA24',
    'timeout_timestamps_LGA25',
    'timeout_timestamps_LGA26',
    'timeout_timestamps_LGA27',
    'timeout_timestamps_LGA28',
    'inactive_timestamps_LGA15',
    'inactive_timestamps_LGA16',
    'inactive_timestamps_LGA17',
    'inactive_timestamps_LGA18',
    'inactive_timestamps_LGA19',
    'inactive_timestamps_LGA20',
    'inactive_timestamps_LGA21',
    'inactive_timestamps_LGA22',
    'inactive_timestamps_LGA23',
    'inactive_timestamps_LGA24',
    'inactive_timestamps_LGA25',
    'inactive_timestamps_LGA26',
    'inactive_timestamps_LGA27',
    'inactive_timestamps_LGA28',
    'vf1_right_force_1',
    'vf1_right_force_2',
    'vf1_right_force_3',
    'vf1_right_force_avg',
    'vf1_right_time_1',
    'vf1_right_time_2',
    'vf1_right_time_3',
    'vf1_right_avg',
    'vf1_left_force_1',
    'vf1_left_force_2',
    'vf1_left_force_3',
    'vf1_left_force_avg',
    'vf1_left_time_1',
    'vf1_left_time_2',
    'vf1_left_time_3',
    'vf1_left_avg',
    'vf2_right_force_1',
    'vf2_right_force_2',
    'vf2_right_force_3',
    'vf2_right_force_avg',
    'vf2_right_time_1',
    'vf2_right_time_2',
    'vf2_right_time_3',
    'vf2_right_avg',
    'vf2_left_force_1',
    'vf2_left_force_2',
    'vf2_left_force_3',
    'vf2_left_force_avg',
    'vf2_left_time_1',
    'vf2_left_time_2',
    'vf2_left_time_3',
    'vf2_left_avg',
    'def_bsl_irr_1',
    'agg_bsl_irr_1',
    'irr_bsl_tot_1',
    'def_bsl_irr_2',
    'agg_bsl_irr_2',
    'irr_bsl_total_2',
    'def_bsl_irr_3',
    'agg_bsl_irr_3',
    'irr_bsl_total_3',
    'def_drug_irr_1',
    'agg_drug_irr_1',
    'irr_drug_tot_1',
    'def_drug_irr_2',
    'agg_drug_irr_2',
    'irr_drug_total_2',
    'def_drug_irr_3',
    'agg_drug_irr_3',
    'irr_drug_total_3',
    'measurement_value_feces_1',
    'measurement_value_feces_2',
    'measurement_value_feces_3',
    'measurement_value_feces_4',
    'measurement_value_urine_1',
    'measurement_value_urine_2',
    'measurement_value_weight_1',
    'measurement_value_weight_2',
    'measurement_value_weight_3',
    'measurement_value_weight_4',
    'measurement_value_weight_5',
    'measurement_value_weight_6',
    'measurement_value_weight_7',
    'measurement_value_weight_8',
    'measurement_value_weight_9',
    'measurement_value_weight_10',
    'days_of_experiment',
    'age_at_arrival',
    'age_at_surgery',
    'age_at_sha',
    'age_at_lga',
    'age_at_dissection',
    'dissection_date',
    'date_of_death',
    'exit_day',
    'date_of_birth',
    'date_of_wean',
    'date_of_ship',
    'arrival_date',
    'date_of_eye_bleed',
    'surgery_date',
    'recatheter_surgery_date',
    'short_access_start_date',
    'short_access_end_date',
    'progressive_ratio_1_date',
    'long_access_start_date',
    'long_access_end_date',
    'progressive_ratio_2_date',
    'pre_shock_date',
    'shock_1_date',
    'shock_2_date',
    'shock_3_date',
    'progressive_ratio_3_date',
    'brevital_date',
    'start_time_SHA01',
    'end_time_SHA01',
    'start_time_SHA02',
    'end_time_SHA02',
    'start_time_SHA03',
    'end_time_SHA03',
    'start_time_SHA04',
    'end_time_SHA04',
    'start_time_SHA05',
    'end_time_SHA05',
    'start_time_SHA06',
    'end_time_SHA06',
    'start_time_SHA07',
    'end_time_SHA07',
    'start_time_SHA08',
    'end_time_SHA08',
    'start_time_SHA09',
    'end_time_SHA09',
    'start_time_SHA10',
    'end_time_SHA10',
    'start_time_LGA01',
    'end_time_LGA01',
    'start_time_LGA02',
    'end_time_LGA02',
    'start_time_LGA03',
    'end_time_LGA03',
    'start_time_LGA04',
    'end_time_LGA04',
    'start_time_LGA05',
    'end_time_LGA05',
    'start_time_LGA06',
    'end_time_LGA06',
    'start_time_LGA07',
    'end_time_LGA07',
    'start_time_LGA08',
    'end_time_LGA08',
    'start_time_LGA09',
    'end_time_LGA09',
    'start_time_LGA10',
    'end_time_LGA10',
    'start_time_LGA11',
    'end_time_LGA11',
    'start_time_LGA12',
    'end_time_LGA12',
    'start_time_LGA13',
    'end_time_LGA13',
    'start_time_LGA14',
    'end_time_LGA14',
    'start_time_PR01',
    'end_time_PR01',
    'start_time_PR02',
    'end_time_PR02',
    'start_time_PR03',
    'end_time_PR03',
    'lga_post_treatment_1_date',
    'lga_post_treatment_2_date',
    'lga_post_treatment_3_date',
    'lga_post_treatment_4_date',
    'treatment_1_start_time',
    'treatment_2_start_time',
    'treatment_3_start_time',
    'treatment_4_start_time',
    'start_time_TREATMENT01',
    'end_time_TREATMENT01', 
    'start_time_TREATMENT02',
    'end_time_TREATMENT02',
    'start_time_TREATMENT03',
    'end_time_TREATMENT03',
    'start_time_TREATMENT04',
    'end_time_TREATMENT04',
    'start_time_PRESHOCK',
    'end_time_PRESHOCK',
    'start_time_SHOCK_V1',
    'end_time_SHOCK_V1',
    'start_time_SHOCK_V2',
    'end_time_SHOCK_V2',
    'start_time_SHOCK_V3',
    'end_time_SHOCK_V3',
    'start_time_SHA11',
    'end_time_SHA11',
    'start_time_LGA15',
    'end_time_LGA15',
    'start_time_LGA16',
    'end_time_LGA16',
    'start_time_LGA17',
    'end_time_LGA17',
    'start_time_LGA18',
    'end_time_LGA18',
    'start_time_LGA19',
    'end_time_LGA19',
    'start_time_LGA20',
    'end_time_LGA20',
    'start_time_LGA21',
    'end_time_LGA21',
    'start_time_LGA22',
    'end_time_LGA22',
    'start_time_LGA23',
    'end_time_LGA23',
    'start_time_LGA24',
    'end_time_LGA24',
    'start_time_LGA25',
    'end_time_LGA25',
    'start_time_LGA26',
    'end_time_LGA26',
    'start_time_LGA27',
    'end_time_LGA27',
    'start_time_LGA28',
    'end_time_LGA28',
    'treatment_1_date',
    'treatment_2_date',
    'treatment_3_date',
    'treatment_4_date',
    'von_frey_1_date',
    'von_frey_2_date',
    'tail_immersion_1_date',
    'tail_immersion_2_date',
    'tail_immersion_3_date',
    'irritability_1_date',
    'irritability_2_date',
    'female_swab_1_date',
    'female_swab_2_date',
    'female_swab_3_date',
    'lga_pre_treatment_1_date',
    'lga_pre_treatment_2_date',
    'lga_pre_treatment_3_date',
    'lga_pre_treatment_4_date',
    'lga_15_date',
    'lga_16_date',
    'lga_17_date',
    'lga_18_date',
    'lga_19_date',
    'lga_20_date',
    'handled_by',
    'surgeon',
    'surgery_assist',
    'recatheter_surgeon',
    'brevital_technicians',
    'irr_bsl_scorer_1',
    'irr_bsl_scorer_2',
    'irr_bsl_scorer_3',
    'irr_drug_scorer_1',
    'irr_drug_scorer_2',
    'irr_drug_scorer_3',
    'irritability_1_technicians',
    'irritability_2_technicians',
    'von_frey_1_technicians',
    'von_frey_2_technicians',
    'tail_immersion_1_technicians',
    'tail_immersion_2_technicians',
    'tail_immersion_3_technicians',
    'female_swab_1_technicians',
    'female_swab_2_technicians',
    'female_swab_3_technicians',
    'technician_urine_1',
    'technician_urine_2',
    'technician_feces_1',
    'technician_feces_2',
    'technician_feces_3',
    'technician_feces_4',
    'technician_weight_1',
    'technician_weight_2',
    'technician_weight_3',
    'technician_weight_4',
    'technician_weight_5',
    'technician_weight_6',
    'technician_weight_7',
    'technician_weight_8',
    'technician_weight_9',
    'technician_weight_10'
]

# COMMAND ----------

len(ordered_cols)

# COMMAND ----------

coc_fail_noncomp_cols = ['female_swab_1_analysis',
    'female_swab_2_analysis',
    'female_swab_3_analysis',
    'reward_presses_SHA01',
    'reward_presses_SHA02',
    'reward_presses_SHA03',
    'reward_presses_SHA04',
    'reward_presses_SHA05',
    'reward_presses_SHA06',
    'reward_presses_SHA07',
    'reward_presses_SHA08',
    'reward_presses_SHA09',
    'reward_presses_SHA10',
    'active_lever_presses_SHA01',
    'active_lever_presses_SHA02',
    'active_lever_presses_SHA03',
    'active_lever_presses_SHA04',
    'active_lever_presses_SHA05',
    'active_lever_presses_SHA06',
    'active_lever_presses_SHA07',
    'active_lever_presses_SHA08',
    'active_lever_presses_SHA09',
    'active_lever_presses_SHA10',
    'timeout_presses_SHA01',
    'timeout_presses_SHA02', 
    'timeout_presses_SHA03',
    'timeout_presses_SHA04',
    'timeout_presses_SHA05',
    'timeout_presses_SHA06',
    'timeout_presses_SHA07',
    'timeout_presses_SHA08',
    'timeout_presses_SHA09',
    'timeout_presses_SHA10',
    'inactive_lever_presses_SHA01',
    'inactive_lever_presses_SHA02',
    'inactive_lever_presses_SHA03',
    'inactive_lever_presses_SHA04',
    'inactive_lever_presses_SHA05',
    'inactive_lever_presses_SHA06',
    'inactive_lever_presses_SHA07',
    'inactive_lever_presses_SHA08',
    'inactive_lever_presses_SHA09',
    'inactive_lever_presses_SHA10',
    'reward_presses_LGA01',
    'reward_presses_LGA02',
    'reward_presses_LGA03',
    'reward_presses_LGA04',
    'reward_presses_LGA05',
    'reward_presses_LGA06',
    'reward_presses_LGA07',
    'reward_presses_LGA08',
    'reward_presses_LGA09',
    'reward_presses_LGA10',
    'reward_presses_LGA11',
    'reward_presses_LGA12',
    'reward_presses_LGA13',
    'reward_presses_LGA14',
    'active_lever_presses_LGA01',
    'active_lever_presses_LGA02',
    'active_lever_presses_LGA03',
    'active_lever_presses_LGA04',
    'active_lever_presses_LGA05',
    'active_lever_presses_LGA06',
    'active_lever_presses_LGA07',
    'active_lever_presses_LGA08',
    'active_lever_presses_LGA09',
    'active_lever_presses_LGA10',
    'active_lever_presses_LGA11',
    'active_lever_presses_LGA12',
    'active_lever_presses_LGA13',
    'active_lever_presses_LGA14',
    'timeout_presses_LGA01',
    'timeout_presses_LGA02',
    'timeout_presses_LGA03',
    'timeout_presses_LGA04',
    'timeout_presses_LGA05',
    'timeout_presses_LGA06',
    'timeout_presses_LGA07',
    'timeout_presses_LGA08',
    'timeout_presses_LGA09',
    'timeout_presses_LGA10',
    'timeout_presses_LGA11',
    'timeout_presses_LGA12',
    'timeout_presses_LGA13',
    'timeout_presses_LGA14',
    'inactive_lever_presses_LGA01',
    'inactive_lever_presses_LGA02',
    'inactive_lever_presses_LGA03',
    'inactive_lever_presses_LGA04',
    'inactive_lever_presses_LGA05',
    'inactive_lever_presses_LGA06',
    'inactive_lever_presses_LGA07',
    'inactive_lever_presses_LGA08',
    'inactive_lever_presses_LGA09',
    'inactive_lever_presses_LGA10',
    'inactive_lever_presses_LGA11',
    'inactive_lever_presses_LGA12',
    'inactive_lever_presses_LGA13',
    'inactive_lever_presses_LGA14',
    'reward_presses_PR01',
    'reward_presses_PR02',
    'reward_presses_PR03',
    'active_lever_presses_PR01',
    'active_lever_presses_PR02',
    'active_lever_presses_PR03',
    'inactive_lever_presses_PR01',
    'inactive_lever_presses_PR02',
    'inactive_lever_presses_PR03',
    'breakpoint_PR01',
    'breakpoint_PR02',
    'breakpoint_PR03',
    'last_ratio_PR01',
    'last_ratio_PR02',
    'last_ratio_PR03',
    'treatment_1_group',
    'treatment_2_group',
    'treatment_3_group',
    'treatment_4_group',
    'reward_presses_TREATMENT01',
    'reward_presses_TREATMENT02',
    'reward_presses_TREATMENT03',
    'reward_presses_TREATMENT04',
    'active_lever_presses_TREATMENT01',
    'active_lever_presses_TREATMENT02',
    'active_lever_presses_TREATMENT03',
    'active_lever_presses_TREATMENT04',
    'inactive_lever_presses_TREATMENT01',
    'inactive_lever_presses_TREATMENT02',
    'inactive_lever_presses_TREATMENT03',
    'inactive_lever_presses_TREATMENT04',
    'breakpoint_TREATMENT01',
    'breakpoint_TREATMENT02',
    'breakpoint_TREATMENT03',
    'breakpoint_TREATMENT04',
    'last_ratio_TREATMENT01',
    'last_ratio_TREATMENT02',
    'last_ratio_TREATMENT03',
    'last_ratio_TREATMENT04',
    'total_reward_PRESHOCK',
    'total_reward_SHOCK_V1',
    'total_reward_SHOCK_V2',
    'total_reward_SHOCK_V3',
    'total_active_lever_presses_PRESHOCK',
    'total_active_lever_presses_SHOCK_V1',
    'total_active_lever_presses_SHOCK_V2',
    'total_active_lever_presses_SHOCK_V3',
    'total_inactive_lever_presses_PRESHOCK',
    'total_inactive_lever_presses_SHOCK_V1',
    'total_inactive_lever_presses_SHOCK_V2',
    'total_inactive_lever_presses_SHOCK_V3',
    'total_shocks_PRESHOCK',
    'total_shocks_SHOCK_V1',
    'total_shocks_SHOCK_V2',
    'total_shocks_SHOCK_V3',
    'rewards_after_first_shock_PRESHOCK',
    'rewards_after_first_shock_SHOCK_V1',
    'rewards_after_first_shock_SHOCK_V2',
    'rewards_after_first_shock_SHOCK_V3',
    'reward_presses_SHA11',
    'active_lever_presses_SHA11',
    'timeout_presses_SHA11',
    'inactive_lever_presses_SHA11',
    'reward_presses_LGA15',
    'reward_presses_LGA16',
    'reward_presses_LGA17',
    'reward_presses_LGA18',
    'reward_presses_LGA19',
    'reward_presses_LGA20',
    'reward_presses_LGA21',
    'reward_presses_LGA22',
    'reward_presses_LGA23',
    'reward_presses_LGA24',
    'reward_presses_LGA25',
    'reward_presses_LGA26',
    'reward_presses_LGA27',
    'reward_presses_LGA28',
    'active_lever_presses_LGA15',
    'active_lever_presses_LGA16',
    'active_lever_presses_LGA17',
    'active_lever_presses_LGA18',
    'active_lever_presses_LGA19',
    'active_lever_presses_LGA20',
    'active_lever_presses_LGA21',
    'active_lever_presses_LGA22',
    'active_lever_presses_LGA23',
    'active_lever_presses_LGA24',
    'active_lever_presses_LGA25',
    'active_lever_presses_LGA26',
    'active_lever_presses_LGA27',
    'active_lever_presses_LGA28',
    'timeout_presses_LGA15',
    'timeout_presses_LGA16',
    'timeout_presses_LGA17',
    'timeout_presses_LGA18',
    'timeout_presses_LGA19',
    'timeout_presses_LGA20',
    'timeout_presses_LGA21',
    'timeout_presses_LGA22',
    'timeout_presses_LGA23',
    'timeout_presses_LGA24',
    'timeout_presses_LGA25',
    'timeout_presses_LGA26',
    'timeout_presses_LGA27',
    'timeout_presses_LGA28',
    'inactive_lever_presses_LGA15',
    'inactive_lever_presses_LGA16',
    'inactive_lever_presses_LGA17',
    'inactive_lever_presses_LGA18',
    'inactive_lever_presses_LGA19',
    'inactive_lever_presses_LGA20',
    'inactive_lever_presses_LGA21',
    'inactive_lever_presses_LGA22',
    'inactive_lever_presses_LGA23',
    'inactive_lever_presses_LGA24',
    'inactive_lever_presses_LGA25',
    'inactive_lever_presses_LGA26',
    'inactive_lever_presses_LGA27',
    'inactive_lever_presses_LGA28',
    'von_frey_1_force',
    'von_frey_1_time',
    'von_frey_2_force',
    'von_frey_2_time',
    'von_frey_difference_force',
    'tail_immersion_1_time',
    'tail_immersion_2_time',
    'tail_immersion_3_time',
    'tail_immersion_difference_tolerance',
    'def_bsl_ave',
    'agg_bsl_ave',
    'total_bsl_ave',
    'def_drug_ave',
    'agg_drug_ave',
    'total_drug_ave',
    'diff_ave_def',
    'diff_ave_agg',
    'diff_ave_total',
    'reward_timestamps_SHA01',
    'reward_timestamps_SHA02',
    'reward_timestamps_SHA03',
    'reward_timestamps_SHA04',
    'reward_timestamps_SHA05',
    'reward_timestamps_SHA06',
    'reward_timestamps_SHA07',
    'reward_timestamps_SHA08',
    'reward_timestamps_SHA09',
    'reward_timestamps_SHA10',
    'active_timestamps_SHA01',
    'active_timestamps_SHA02',
    'active_timestamps_SHA03',
    'active_timestamps_SHA04',
    'active_timestamps_SHA05',
    'active_timestamps_SHA06',
    'active_timestamps_SHA07',
    'active_timestamps_SHA08',
    'active_timestamps_SHA09',
    'active_timestamps_SHA10',
    'timeout_timestamps_SHA01',
    'timeout_timestamps_SHA02',
    'timeout_timestamps_SHA03',
    'timeout_timestamps_SHA04',
    'timeout_timestamps_SHA05',
    'timeout_timestamps_SHA06',
    'timeout_timestamps_SHA07',
    'timeout_timestamps_SHA08',
    'timeout_timestamps_SHA09',
    'timeout_timestamps_SHA10',
    'inactive_timestamps_SHA01',
    'inactive_timestamps_SHA02',
    'inactive_timestamps_SHA03',
    'inactive_timestamps_SHA04',
    'inactive_timestamps_SHA05',
    'inactive_timestamps_SHA06',
    'inactive_timestamps_SHA07',
    'inactive_timestamps_SHA08',
    'inactive_timestamps_SHA09',
    'inactive_timestamps_SHA10',
    'reward_timestamps_LGA01',
    'reward_timestamps_LGA02',
    'reward_timestamps_LGA03',
    'reward_timestamps_LGA04',
    'reward_timestamps_LGA05',
    'reward_timestamps_LGA06',
    'reward_timestamps_LGA07',
    'reward_timestamps_LGA08',
    'reward_timestamps_LGA09',
    'reward_timestamps_LGA10',
    'reward_timestamps_LGA11',
    'reward_timestamps_LGA12',
    'reward_timestamps_LGA13',
    'reward_timestamps_LGA14',
    'active_timestamps_LGA01',
    'active_timestamps_LGA02',
    'active_timestamps_LGA03',
    'active_timestamps_LGA04',
    'active_timestamps_LGA05',
    'active_timestamps_LGA06',
    'active_timestamps_LGA07',
    'active_timestamps_LGA08',
    'active_timestamps_LGA09',
    'active_timestamps_LGA10',
    'active_timestamps_LGA11',
    'active_timestamps_LGA12',
    'active_timestamps_LGA13',
    'active_timestamps_LGA14',
    'timeout_timestamps_LGA01',
    'timeout_timestamps_LGA02',
    'timeout_timestamps_LGA03',
    'timeout_timestamps_LGA04',
    'timeout_timestamps_LGA05',
    'timeout_timestamps_LGA06',
    'timeout_timestamps_LGA07',
    'timeout_timestamps_LGA08',
    'timeout_timestamps_LGA09',
    'timeout_timestamps_LGA10',
    'timeout_timestamps_LGA11',
    'timeout_timestamps_LGA12',
    'timeout_timestamps_LGA13',
    'timeout_timestamps_LGA14',
    'inactive_timestamps_LGA01',
    'inactive_timestamps_LGA02',
    'inactive_timestamps_LGA03',
    'inactive_timestamps_LGA04',
    'inactive_timestamps_LGA05',
    'inactive_timestamps_LGA06',
    'inactive_timestamps_LGA07',
    'inactive_timestamps_LGA08',
    'inactive_timestamps_LGA09',
    'inactive_timestamps_LGA10',
    'inactive_timestamps_LGA11',
    'inactive_timestamps_LGA12',
    'inactive_timestamps_LGA13',
    'inactive_timestamps_LGA14',
    'ratios_PR01',
    'ratios_PR02',
    'ratios_PR03',
    'ratios_TREATMENT01',
    'ratios_TREATMENT02',
    'ratios_TREATMENT03',
    'ratios_TREATMENT04',
    'group_pre_shock',
    'group_shock',
    'rewards_got_shock_PRESHOCK',
    'rewards_got_shock_SHOCK_V1',
    'rewards_got_shock_SHOCK_V2',
    'rewards_got_shock_SHOCK_V3',
    'reward_timestamps_PRESHOCK',
    'reward_timestamps_SHOCK_V1',
    'reward_timestamps_SHOCK_V2',
    'reward_timestamps_SHOCK_V3',
    'reward_timestamps_SHA11',
    'active_timestamps_SHA11',
    'timeout_timestamps_SHA11',
    'inactive_timestamps_SHA11',
    'reward_timestamps_LGA15',
    'reward_timestamps_LGA16',
    'reward_timestamps_LGA17',
    'reward_timestamps_LGA18',
    'reward_timestamps_LGA19',
    'reward_timestamps_LGA20',
    'reward_timestamps_LGA21',
    'reward_timestamps_LGA22',
    'reward_timestamps_LGA23',
    'reward_timestamps_LGA24',
    'reward_timestamps_LGA25',
    'reward_timestamps_LGA26',
    'reward_timestamps_LGA27',
    'reward_timestamps_LGA28',
    'active_timestamps_LGA15',
    'active_timestamps_LGA16',
    'active_timestamps_LGA17',
    'active_timestamps_LGA18',
    'active_timestamps_LGA19',
    'active_timestamps_LGA20',
    'active_timestamps_LGA21',
    'active_timestamps_LGA22',
    'active_timestamps_LGA23',
    'active_timestamps_LGA24',
    'active_timestamps_LGA25',
    'active_timestamps_LGA26',
    'active_timestamps_LGA27',
    'active_timestamps_LGA28',
    'timeout_timestamps_LGA15',
    'timeout_timestamps_LGA16',
    'timeout_timestamps_LGA17',
    'timeout_timestamps_LGA18',
    'timeout_timestamps_LGA19',
    'timeout_timestamps_LGA20',
    'timeout_timestamps_LGA21',
    'timeout_timestamps_LGA22',
    'timeout_timestamps_LGA23',
    'timeout_timestamps_LGA24',
    'timeout_timestamps_LGA25',
    'timeout_timestamps_LGA26',
    'timeout_timestamps_LGA27',
    'timeout_timestamps_LGA28',
    'inactive_timestamps_LGA15',
    'inactive_timestamps_LGA16',
    'inactive_timestamps_LGA17',
    'inactive_timestamps_LGA18',
    'inactive_timestamps_LGA19',
    'inactive_timestamps_LGA20',
    'inactive_timestamps_LGA21',
    'inactive_timestamps_LGA22',
    'inactive_timestamps_LGA23',
    'inactive_timestamps_LGA24',
    'inactive_timestamps_LGA25',
    'inactive_timestamps_LGA26',
    'inactive_timestamps_LGA27',
    'inactive_timestamps_LGA28',
    'vf1_right_force_1',
    'vf1_right_force_2',
    'vf1_right_force_3',
    'vf1_right_force_avg',
    'vf1_right_time_1',
    'vf1_right_time_2',
    'vf1_right_time_3',
    'vf1_right_avg',
    'vf1_left_force_1',
    'vf1_left_force_2',
    'vf1_left_force_3',
    'vf1_left_force_avg',
    'vf1_left_time_1',
    'vf1_left_time_2',
    'vf1_left_time_3',
    'vf1_left_avg',
    'vf2_right_force_1',
    'vf2_right_force_2',
    'vf2_right_force_3',
    'vf2_right_force_avg',
    'vf2_right_time_1',
    'vf2_right_time_2',
    'vf2_right_time_3',
    'vf2_right_avg',
    'vf2_left_force_1',
    'vf2_left_force_2',
    'vf2_left_force_3',
    'vf2_left_force_avg',
    'vf2_left_time_1',
    'vf2_left_time_2',
    'vf2_left_time_3',
    'vf2_left_avg',
    'def_bsl_irr_1',
    'agg_bsl_irr_1',
    'irr_bsl_tot_1',
    'def_bsl_irr_2',
    'agg_bsl_irr_2',
    'irr_bsl_total_2',
    'def_bsl_irr_3',
    'agg_bsl_irr_3',
    'irr_bsl_total_3',
    'def_drug_irr_1',
    'agg_drug_irr_1',
    'irr_drug_tot_1',
    'def_drug_irr_2',
    'agg_drug_irr_2',
    'irr_drug_total_2',
    'def_drug_irr_3',
    'agg_drug_irr_3',
    'irr_drug_total_3',
    'measurement_value_feces_1',
    'measurement_value_feces_2',
    'measurement_value_feces_3',
    'measurement_value_feces_4',
    'measurement_value_urine_1',
    'measurement_value_urine_2',
    'measurement_value_weight_1',
    'measurement_value_weight_2',
    'measurement_value_weight_3',
    'measurement_value_weight_4',
    'measurement_value_weight_5',
    'measurement_value_weight_6',
    'measurement_value_weight_7',
    'measurement_value_weight_8',
    'measurement_value_weight_9',
    'measurement_value_weight_10',
    'days_of_experiment',
    'age_at_arrival',
    'age_at_surgery',
    'age_at_sha',
    'age_at_lga',
    'age_at_dissection',
    'dissection_date',
    'date_of_death',
    'exit_day',
    'date_of_birth',
    'date_of_wean',
    'date_of_ship',
    'arrival_date',
    'date_of_eye_bleed',
    'surgery_date',
    'recatheter_surgery_date',
    'short_access_start_date',
    'short_access_end_date',
    'progressive_ratio_1_date',
    'long_access_start_date',
    'long_access_end_date',
    'progressive_ratio_2_date',
    'pre_shock_date',
    'shock_1_date',
    'shock_2_date',
    'shock_3_date',
    'progressive_ratio_3_date',
    'brevital_date',
    'start_time_SHA01',
    'end_time_SHA01',
    'start_time_SHA02',
    'end_time_SHA02',
    'start_time_SHA03',
    'end_time_SHA03',
    'start_time_SHA04',
    'end_time_SHA04',
    'start_time_SHA05',
    'end_time_SHA05',
    'start_time_SHA06',
    'end_time_SHA06',
    'start_time_SHA07',
    'end_time_SHA07',
    'start_time_SHA08',
    'end_time_SHA08',
    'start_time_SHA09',
    'end_time_SHA09',
    'start_time_SHA10',
    'end_time_SHA10',
    'start_time_LGA01',
    'end_time_LGA01',
    'start_time_LGA02',
    'end_time_LGA02',
    'start_time_LGA03',
    'end_time_LGA03',
    'start_time_LGA04',
    'end_time_LGA04',
    'start_time_LGA05',
    'end_time_LGA05',
    'start_time_LGA06',
    'end_time_LGA06',
    'start_time_LGA07',
    'end_time_LGA07',
    'start_time_LGA08',
    'end_time_LGA08',
    'start_time_LGA09',
    'end_time_LGA09',
    'start_time_LGA10',
    'end_time_LGA10',
    'start_time_LGA11',
    'end_time_LGA11',
    'start_time_LGA12',
    'end_time_LGA12',
    'start_time_LGA13',
    'end_time_LGA13',
    'start_time_LGA14',
    'end_time_LGA14',
    'start_time_PR01',
    'end_time_PR01',
    'start_time_PR02',
    'end_time_PR02',
    'start_time_PR03',
    'end_time_PR03',
    'lga_post_treatment_1_date',
    'lga_post_treatment_2_date',
    'lga_post_treatment_3_date',
    'lga_post_treatment_4_date',
    'treatment_1_start_time',
    'treatment_2_start_time',
    'treatment_3_start_time',
    'treatment_4_start_time',
    'start_time_TREATMENT01',
    'end_time_TREATMENT01', 
    'start_time_TREATMENT02',
    'end_time_TREATMENT02',
    'start_time_TREATMENT03',
    'end_time_TREATMENT03',
    'start_time_TREATMENT04',
    'end_time_TREATMENT04',
    'start_time_PRESHOCK',
    'end_time_PRESHOCK',
    'start_time_SHOCK_V1',
    'end_time_SHOCK_V1',
    'start_time_SHOCK_V2',
    'end_time_SHOCK_V2',
    'start_time_SHOCK_V3',
    'end_time_SHOCK_V3',
    'start_time_SHA11',
    'end_time_SHA11',
    'start_time_LGA15',
    'end_time_LGA15',
    'start_time_LGA16',
    'end_time_LGA16',
    'start_time_LGA17',
    'end_time_LGA17',
    'start_time_LGA18',
    'end_time_LGA18',
    'start_time_LGA19',
    'end_time_LGA19',
    'start_time_LGA20',
    'end_time_LGA20',
    'start_time_LGA21',
    'end_time_LGA21',
    'start_time_LGA22',
    'end_time_LGA22',
    'start_time_LGA23',
    'end_time_LGA23',
    'start_time_LGA24',
    'end_time_LGA24',
    'start_time_LGA25',
    'end_time_LGA25',
    'start_time_LGA26',
    'end_time_LGA26',
    'start_time_LGA27',
    'end_time_LGA27',
    'start_time_LGA28',
    'end_time_LGA28',
    'treatment_1_date',
    'treatment_2_date',
    'treatment_3_date',
    'treatment_4_date',
    'von_frey_1_date',
    'von_frey_2_date',
    'tail_immersion_1_date',
    'tail_immersion_2_date',
    'tail_immersion_3_date',
    'irritability_1_date',
    'irritability_2_date',
    'female_swab_1_date',
    'female_swab_2_date',
    'female_swab_3_date',
    'lga_pre_treatment_1_date',
    'lga_pre_treatment_2_date',
    'lga_pre_treatment_3_date',
    'lga_pre_treatment_4_date',
    'lga_15_date',
    'lga_16_date',
    'lga_17_date',
    'lga_18_date',
    'lga_19_date',
    'lga_20_date',
    'handled_by',
    'surgeon',
    'surgery_assist',
    'recatheter_surgeon',
    'brevital_technicians',
    'irr_bsl_scorer_1',
    'irr_bsl_scorer_2',
    'irr_bsl_scorer_3',
    'irr_drug_scorer_1',
    'irr_drug_scorer_2',
    'irr_drug_scorer_3',
    'irritability_1_technicians',
    'irritability_2_technicians',
    'von_frey_1_technicians',
    'von_frey_2_technicians',
    'tail_immersion_1_technicians',
    'tail_immersion_2_technicians',
    'tail_immersion_3_technicians',
    'female_swab_1_technicians',
    'female_swab_2_technicians',
    'female_swab_3_technicians',
    'technician_urine_1',
    'technician_urine_2',
    'technician_feces_1',
    'technician_feces_2',
    'technician_feces_3',
    'technician_feces_4',
    'technician_weight_1',
    'technician_weight_2',
    'technician_weight_3',
    'technician_weight_4',
    'technician_weight_5',
    'technician_weight_6',
    'technician_weight_7',
    'technician_weight_8',
    'technician_weight_9',
    'technician_weight_10']
coc_fail_comp_cols = ['female_swab_1_analysis',
    'female_swab_2_analysis',
    'female_swab_3_analysis',
    'treatment_1_group',
    'treatment_2_group',
    'treatment_3_group',
    'treatment_4_group',
    'reward_presses_TREATMENT01',
    'reward_presses_TREATMENT02',
    'reward_presses_TREATMENT03',
    'reward_presses_TREATMENT04',
    'active_lever_presses_TREATMENT01',
    'active_lever_presses_TREATMENT02',
    'active_lever_presses_TREATMENT03',
    'active_lever_presses_TREATMENT04',
    'inactive_lever_presses_TREATMENT01',
    'inactive_lever_presses_TREATMENT02',
    'inactive_lever_presses_TREATMENT03',
    'inactive_lever_presses_TREATMENT04',
    'breakpoint_TREATMENT01',
    'breakpoint_TREATMENT02',
    'breakpoint_TREATMENT03',
    'breakpoint_TREATMENT04',
    'last_ratio_TREATMENT01',
    'last_ratio_TREATMENT02',
    'last_ratio_TREATMENT03',
    'last_ratio_TREATMENT04',
    'total_reward_PRESHOCK',
    'total_reward_SHOCK_V1',
    'total_reward_SHOCK_V2',
    'total_reward_SHOCK_V3',
    'total_active_lever_presses_PRESHOCK',
    'total_active_lever_presses_SHOCK_V1',
    'total_active_lever_presses_SHOCK_V2',
    'total_active_lever_presses_SHOCK_V3',
    'total_inactive_lever_presses_PRESHOCK',
    'total_inactive_lever_presses_SHOCK_V1',
    'total_inactive_lever_presses_SHOCK_V2',
    'total_inactive_lever_presses_SHOCK_V3',
    'total_shocks_PRESHOCK',
    'total_shocks_SHOCK_V1',
    'total_shocks_SHOCK_V2',
    'total_shocks_SHOCK_V3',
    'rewards_after_first_shock_PRESHOCK',
    'rewards_after_first_shock_SHOCK_V1',
    'rewards_after_first_shock_SHOCK_V2',
    'rewards_after_first_shock_SHOCK_V3',
    'reward_presses_SHA11',
    'active_lever_presses_SHA11',
    'timeout_presses_SHA11',
    'inactive_lever_presses_SHA11',
    'reward_presses_LGA15',
    'reward_presses_LGA16',
    'reward_presses_LGA17',
    'reward_presses_LGA18',
    'reward_presses_LGA19',
    'reward_presses_LGA20',
    'reward_presses_LGA21',
    'reward_presses_LGA22',
    'reward_presses_LGA23',
    'reward_presses_LGA24',
    'reward_presses_LGA25',
    'reward_presses_LGA26',
    'reward_presses_LGA27',
    'reward_presses_LGA28',
    'active_lever_presses_LGA15',
    'active_lever_presses_LGA16',
    'active_lever_presses_LGA17',
    'active_lever_presses_LGA18',
    'active_lever_presses_LGA19',
    'active_lever_presses_LGA20',
    'active_lever_presses_LGA21',
    'active_lever_presses_LGA22',
    'active_lever_presses_LGA23',
    'active_lever_presses_LGA24',
    'active_lever_presses_LGA25',
    'active_lever_presses_LGA26',
    'active_lever_presses_LGA27',
    'active_lever_presses_LGA28',
    'timeout_presses_LGA15',
    'timeout_presses_LGA16',
    'timeout_presses_LGA17',
    'timeout_presses_LGA18',
    'timeout_presses_LGA19',
    'timeout_presses_LGA20',
    'timeout_presses_LGA21',
    'timeout_presses_LGA22',
    'timeout_presses_LGA23',
    'timeout_presses_LGA24',
    'timeout_presses_LGA25',
    'timeout_presses_LGA26',
    'timeout_presses_LGA27',
    'timeout_presses_LGA28',
    'inactive_lever_presses_LGA15',
    'inactive_lever_presses_LGA16',
    'inactive_lever_presses_LGA17',
    'inactive_lever_presses_LGA18',
    'inactive_lever_presses_LGA19',
    'inactive_lever_presses_LGA20',
    'inactive_lever_presses_LGA21',
    'inactive_lever_presses_LGA22',
    'inactive_lever_presses_LGA23',
    'inactive_lever_presses_LGA24',
    'inactive_lever_presses_LGA25',
    'inactive_lever_presses_LGA26',
    'inactive_lever_presses_LGA27',
    'inactive_lever_presses_LGA28',
    'von_frey_1_force',
    'von_frey_1_time',
    'von_frey_2_force',
    'von_frey_2_time',
    'von_frey_difference_force',
    'tail_immersion_1_time',
    'tail_immersion_2_time',
    'tail_immersion_3_time',
    'tail_immersion_difference_tolerance',
    'def_bsl_ave',
    'agg_bsl_ave',
    'total_bsl_ave',
    'def_drug_ave',
    'agg_drug_ave',
    'total_drug_ave',
    'diff_ave_def',
    'diff_ave_agg',
    'diff_ave_total',
    'ratios_TREATMENT01',
    'ratios_TREATMENT02',
    'ratios_TREATMENT03',
    'ratios_TREATMENT04',
    'group_pre_shock',
    'group_shock',
    'rewards_got_shock_PRESHOCK',
    'rewards_got_shock_SHOCK_V1',
    'rewards_got_shock_SHOCK_V2',
    'rewards_got_shock_SHOCK_V3',
    'reward_timestamps_PRESHOCK',
    'reward_timestamps_SHOCK_V1',
    'reward_timestamps_SHOCK_V2',
    'reward_timestamps_SHOCK_V3',
    'reward_timestamps_SHA11',
    'active_timestamps_SHA11',
    'timeout_timestamps_SHA11',
    'inactive_timestamps_SHA11',
    'reward_timestamps_LGA15',
    'reward_timestamps_LGA16',
    'reward_timestamps_LGA17',
    'reward_timestamps_LGA18',
    'reward_timestamps_LGA19',
    'reward_timestamps_LGA20',
    'reward_timestamps_LGA21',
    'reward_timestamps_LGA22',
    'reward_timestamps_LGA23',
    'reward_timestamps_LGA24',
    'reward_timestamps_LGA25',
    'reward_timestamps_LGA26',
    'reward_timestamps_LGA27',
    'reward_timestamps_LGA28',
    'active_timestamps_LGA15',
    'active_timestamps_LGA16',
    'active_timestamps_LGA17',
    'active_timestamps_LGA18',
    'active_timestamps_LGA19',
    'active_timestamps_LGA20',
    'active_timestamps_LGA21',
    'active_timestamps_LGA22',
    'active_timestamps_LGA23',
    'active_timestamps_LGA24',
    'active_timestamps_LGA25',
    'active_timestamps_LGA26',
    'active_timestamps_LGA27',
    'active_timestamps_LGA28',
    'timeout_timestamps_LGA15',
    'timeout_timestamps_LGA16',
    'timeout_timestamps_LGA17',
    'timeout_timestamps_LGA18',
    'timeout_timestamps_LGA19',
    'timeout_timestamps_LGA20',
    'timeout_timestamps_LGA21',
    'timeout_timestamps_LGA22',
    'timeout_timestamps_LGA23',
    'timeout_timestamps_LGA24',
    'timeout_timestamps_LGA25',
    'timeout_timestamps_LGA26',
    'timeout_timestamps_LGA27',
    'timeout_timestamps_LGA28',
    'inactive_timestamps_LGA15',
    'inactive_timestamps_LGA16',
    'inactive_timestamps_LGA17',
    'inactive_timestamps_LGA18',
    'inactive_timestamps_LGA19',
    'inactive_timestamps_LGA20',
    'inactive_timestamps_LGA21',
    'inactive_timestamps_LGA22',
    'inactive_timestamps_LGA23',
    'inactive_timestamps_LGA24',
    'inactive_timestamps_LGA25',
    'inactive_timestamps_LGA26',
    'inactive_timestamps_LGA27',
    'inactive_timestamps_LGA28',
    'vf1_right_force_1',
    'vf1_right_force_2',
    'vf1_right_force_3',
    'vf1_right_force_avg',
    'vf1_right_time_1',
    'vf1_right_time_2',
    'vf1_right_time_3',
    'vf1_right_avg',
    'vf1_left_force_1',
    'vf1_left_force_2',
    'vf1_left_force_3',
    'vf1_left_force_avg',
    'vf1_left_time_1',
    'vf1_left_time_2',
    'vf1_left_time_3',
    'vf1_left_avg',
    'vf2_right_force_1',
    'vf2_right_force_2',
    'vf2_right_force_3',
    'vf2_right_force_avg',
    'vf2_right_time_1',
    'vf2_right_time_2',
    'vf2_right_time_3',
    'vf2_right_avg',
    'vf2_left_force_1',
    'vf2_left_force_2',
    'vf2_left_force_3',
    'vf2_left_force_avg',
    'vf2_left_time_1',
    'vf2_left_time_2',
    'vf2_left_time_3',
    'vf2_left_avg',
    'def_bsl_irr_1',
    'agg_bsl_irr_1',
    'irr_bsl_tot_1',
    'def_bsl_irr_2',
    'agg_bsl_irr_2',
    'irr_bsl_total_2',
    'def_bsl_irr_3',
    'agg_bsl_irr_3',
    'irr_bsl_total_3',
    'def_drug_irr_1',
    'agg_drug_irr_1',
    'irr_drug_tot_1',
    'def_drug_irr_2',
    'agg_drug_irr_2',
    'irr_drug_total_2',
    'def_drug_irr_3',
    'agg_drug_irr_3',
    'irr_drug_total_3',
    'measurement_value_feces_1',
    'measurement_value_feces_2',
    'measurement_value_feces_3',
    'measurement_value_feces_4',
    'measurement_value_urine_1',
    'measurement_value_urine_2',
    'measurement_value_weight_1',
    'measurement_value_weight_2',
    'measurement_value_weight_3',
    'measurement_value_weight_4',
    'measurement_value_weight_5',
    'measurement_value_weight_6',
    'measurement_value_weight_7',
    'measurement_value_weight_8',
    'measurement_value_weight_9',
    'measurement_value_weight_10',
    'days_of_experiment',
    'age_at_arrival',
    'age_at_surgery',
    'age_at_sha',
    'age_at_lga',
    'age_at_dissection',
    'dissection_date',
    'date_of_death',
    'exit_day',
    'date_of_birth',
    'date_of_wean',
    'date_of_ship',
    'arrival_date',
    'date_of_eye_bleed',
    'surgery_date',
    'recatheter_surgery_date',
    'short_access_start_date',
    'short_access_end_date',
    'long_access_start_date',
    'long_access_end_date',
    'pre_shock_date',
    'shock_1_date',
    'shock_2_date',
    'shock_3_date',
    'brevital_date',
    'lga_post_treatment_1_date',
    'lga_post_treatment_2_date',
    'lga_post_treatment_3_date',
    'lga_post_treatment_4_date',
    'treatment_1_start_time',
    'treatment_2_start_time',
    'treatment_3_start_time',
    'treatment_4_start_time',
    'start_time_TREATMENT01',
    'end_time_TREATMENT01', 
    'start_time_TREATMENT02',
    'end_time_TREATMENT02',
    'start_time_TREATMENT03',
    'end_time_TREATMENT03',
    'start_time_TREATMENT04',
    'end_time_TREATMENT04',
    'start_time_PRESHOCK',
    'end_time_PRESHOCK',
    'start_time_SHOCK_V1',
    'end_time_SHOCK_V1',
    'start_time_SHOCK_V2',
    'end_time_SHOCK_V2',
    'start_time_SHOCK_V3',
    'end_time_SHOCK_V3',
    'start_time_SHA11',
    'end_time_SHA11',
    'start_time_LGA15',
    'end_time_LGA15',
    'start_time_LGA16',
    'end_time_LGA16',
    'start_time_LGA17',
    'end_time_LGA17',
    'start_time_LGA18',
    'end_time_LGA18',
    'start_time_LGA19',
    'end_time_LGA19',
    'start_time_LGA20',
    'end_time_LGA20',
    'start_time_LGA21',
    'end_time_LGA21',
    'start_time_LGA22',
    'end_time_LGA22',
    'start_time_LGA23',
    'end_time_LGA23',
    'start_time_LGA24',
    'end_time_LGA24',
    'start_time_LGA25',
    'end_time_LGA25',
    'start_time_LGA26',
    'end_time_LGA26',
    'start_time_LGA27',
    'end_time_LGA27',
    'start_time_LGA28',
    'end_time_LGA28',
    'treatment_1_date',
    'treatment_2_date',
    'treatment_3_date',
    'treatment_4_date',
    'von_frey_1_date',
    'von_frey_2_date',
    'tail_immersion_1_date',
    'tail_immersion_2_date',
    'tail_immersion_3_date',
    'irritability_1_date',
    'irritability_2_date',
    'female_swab_1_date',
    'female_swab_2_date',
    'female_swab_3_date',
    'lga_pre_treatment_1_date',
    'lga_pre_treatment_2_date',
    'lga_pre_treatment_3_date',
    'lga_pre_treatment_4_date',
    'lga_15_date',
    'lga_16_date',
    'lga_17_date',
    'lga_18_date',
    'lga_19_date',
    'lga_20_date',
    'handled_by',
    'surgeon',
    'surgery_assist',
    'recatheter_surgeon',
    'brevital_technicians',
    'irr_bsl_scorer_1',
    'irr_bsl_scorer_2',
    'irr_bsl_scorer_3',
    'irr_drug_scorer_1',
    'irr_drug_scorer_2',
    'irr_drug_scorer_3',
    'irritability_1_technicians',
    'irritability_2_technicians',
    'von_frey_1_technicians',
    'von_frey_2_technicians',
    'tail_immersion_1_technicians',
    'tail_immersion_2_technicians',
    'tail_immersion_3_technicians',
    'female_swab_1_technicians',
    'female_swab_2_technicians',
    'female_swab_3_technicians',
    'technician_urine_1',
    'technician_urine_2',
    'technician_feces_1',
    'technician_feces_2',
    'technician_feces_3',
    'technician_feces_4',
    'technician_weight_1',
    'technician_weight_2',
    'technician_weight_3',
    'technician_weight_4',
    'technician_weight_5',
    'technician_weight_6',
    'technician_weight_7',
    'technician_weight_8',
    'technician_weight_9',
    'technician_weight_10']
oxy_fail_noncomp_cols = ['female_swab_1_analysis',
    'female_swab_2_analysis',
    'female_swab_3_analysis',
    'reward_presses_SHA01',
    'reward_presses_SHA02',
    'reward_presses_SHA03',
    'reward_presses_SHA04',
    'reward_presses_SHA05',
    'reward_presses_SHA06',
    'reward_presses_SHA07',
    'reward_presses_SHA08',
    'reward_presses_SHA09',
    'reward_presses_SHA10',
    'active_lever_presses_SHA01',
    'active_lever_presses_SHA02',
    'active_lever_presses_SHA03',
    'active_lever_presses_SHA04',
    'active_lever_presses_SHA05',
    'active_lever_presses_SHA06',
    'active_lever_presses_SHA07',
    'active_lever_presses_SHA08',
    'active_lever_presses_SHA09',
    'active_lever_presses_SHA10',
    'timeout_presses_SHA01',
    'timeout_presses_SHA02', 
    'timeout_presses_SHA03',
    'timeout_presses_SHA04',
    'timeout_presses_SHA05',
    'timeout_presses_SHA06',
    'timeout_presses_SHA07',
    'timeout_presses_SHA08',
    'timeout_presses_SHA09',
    'timeout_presses_SHA10',
    'inactive_lever_presses_SHA01',
    'inactive_lever_presses_SHA02',
    'inactive_lever_presses_SHA03',
    'inactive_lever_presses_SHA04',
    'inactive_lever_presses_SHA05',
    'inactive_lever_presses_SHA06',
    'inactive_lever_presses_SHA07',
    'inactive_lever_presses_SHA08',
    'inactive_lever_presses_SHA09',
    'inactive_lever_presses_SHA10',
    'reward_presses_LGA01',
    'reward_presses_LGA02',
    'reward_presses_LGA03',
    'reward_presses_LGA04',
    'reward_presses_LGA05',
    'reward_presses_LGA06',
    'reward_presses_LGA07',
    'reward_presses_LGA08',
    'reward_presses_LGA09',
    'reward_presses_LGA10',
    'reward_presses_LGA11',
    'reward_presses_LGA12',
    'reward_presses_LGA13',
    'reward_presses_LGA14',
    'active_lever_presses_LGA01',
    'active_lever_presses_LGA02',
    'active_lever_presses_LGA03',
    'active_lever_presses_LGA04',
    'active_lever_presses_LGA05',
    'active_lever_presses_LGA06',
    'active_lever_presses_LGA07',
    'active_lever_presses_LGA08',
    'active_lever_presses_LGA09',
    'active_lever_presses_LGA10',
    'active_lever_presses_LGA11',
    'active_lever_presses_LGA12',
    'active_lever_presses_LGA13',
    'active_lever_presses_LGA14',
    'timeout_presses_LGA01',
    'timeout_presses_LGA02',
    'timeout_presses_LGA03',
    'timeout_presses_LGA04',
    'timeout_presses_LGA05',
    'timeout_presses_LGA06',
    'timeout_presses_LGA07',
    'timeout_presses_LGA08',
    'timeout_presses_LGA09',
    'timeout_presses_LGA10',
    'timeout_presses_LGA11',
    'timeout_presses_LGA12',
    'timeout_presses_LGA13',
    'timeout_presses_LGA14',
    'inactive_lever_presses_LGA01',
    'inactive_lever_presses_LGA02',
    'inactive_lever_presses_LGA03',
    'inactive_lever_presses_LGA04',
    'inactive_lever_presses_LGA05',
    'inactive_lever_presses_LGA06',
    'inactive_lever_presses_LGA07',
    'inactive_lever_presses_LGA08',
    'inactive_lever_presses_LGA09',
    'inactive_lever_presses_LGA10',
    'inactive_lever_presses_LGA11',
    'inactive_lever_presses_LGA12',
    'inactive_lever_presses_LGA13',
    'inactive_lever_presses_LGA14',
    'reward_presses_PR01',
    'reward_presses_PR02',
    'reward_presses_PR03',
    'active_lever_presses_PR01',
    'active_lever_presses_PR02',
    'active_lever_presses_PR03',
    'inactive_lever_presses_PR01',
    'inactive_lever_presses_PR02',
    'inactive_lever_presses_PR03',
    'breakpoint_PR01',
    'breakpoint_PR02',
    'breakpoint_PR03',
    'last_ratio_PR01',
    'last_ratio_PR02',
    'last_ratio_PR03',
    'treatment_1_group',
    'treatment_2_group',
    'treatment_3_group',
    'treatment_4_group',
    'reward_presses_TREATMENT01',
    'reward_presses_TREATMENT02',
    'reward_presses_TREATMENT03',
    'reward_presses_TREATMENT04',
    'active_lever_presses_TREATMENT01',
    'active_lever_presses_TREATMENT02',
    'active_lever_presses_TREATMENT03',
    'active_lever_presses_TREATMENT04',
    'inactive_lever_presses_TREATMENT01',
    'inactive_lever_presses_TREATMENT02',
    'inactive_lever_presses_TREATMENT03',
    'inactive_lever_presses_TREATMENT04',
    'breakpoint_TREATMENT01',
    'breakpoint_TREATMENT02',
    'breakpoint_TREATMENT03',
    'breakpoint_TREATMENT04',
    'last_ratio_TREATMENT01',
    'last_ratio_TREATMENT02',
    'last_ratio_TREATMENT03',
    'last_ratio_TREATMENT04',
    'total_reward_PRESHOCK',
    'total_reward_SHOCK_V1',
    'total_reward_SHOCK_V2',
    'total_reward_SHOCK_V3',
    'total_active_lever_presses_PRESHOCK',
    'total_active_lever_presses_SHOCK_V1',
    'total_active_lever_presses_SHOCK_V2',
    'total_active_lever_presses_SHOCK_V3',
    'total_inactive_lever_presses_PRESHOCK',
    'total_inactive_lever_presses_SHOCK_V1',
    'total_inactive_lever_presses_SHOCK_V2',
    'total_inactive_lever_presses_SHOCK_V3',
    'total_shocks_PRESHOCK',
    'total_shocks_SHOCK_V1',
    'total_shocks_SHOCK_V2',
    'total_shocks_SHOCK_V3',
    'rewards_after_first_shock_PRESHOCK',
    'rewards_after_first_shock_SHOCK_V1',
    'rewards_after_first_shock_SHOCK_V2',
    'rewards_after_first_shock_SHOCK_V3',
    'reward_presses_SHA11',
    'active_lever_presses_SHA11',
    'timeout_presses_SHA11',
    'inactive_lever_presses_SHA11',
    'reward_presses_LGA15',
    'reward_presses_LGA16',
    'reward_presses_LGA17',
    'reward_presses_LGA18',
    'reward_presses_LGA19',
    'reward_presses_LGA20',
    'reward_presses_LGA21',
    'reward_presses_LGA22',
    'reward_presses_LGA23',
    'reward_presses_LGA24',
    'reward_presses_LGA25',
    'reward_presses_LGA26',
    'reward_presses_LGA27',
    'reward_presses_LGA28',
    'active_lever_presses_LGA15',
    'active_lever_presses_LGA16',
    'active_lever_presses_LGA17',
    'active_lever_presses_LGA18',
    'active_lever_presses_LGA19',
    'active_lever_presses_LGA20',
    'active_lever_presses_LGA21',
    'active_lever_presses_LGA22',
    'active_lever_presses_LGA23',
    'active_lever_presses_LGA24',
    'active_lever_presses_LGA25',
    'active_lever_presses_LGA26',
    'active_lever_presses_LGA27',
    'active_lever_presses_LGA28',
    'timeout_presses_LGA15',
    'timeout_presses_LGA16',
    'timeout_presses_LGA17',
    'timeout_presses_LGA18',
    'timeout_presses_LGA19',
    'timeout_presses_LGA20',
    'timeout_presses_LGA21',
    'timeout_presses_LGA22',
    'timeout_presses_LGA23',
    'timeout_presses_LGA24',
    'timeout_presses_LGA25',
    'timeout_presses_LGA26',
    'timeout_presses_LGA27',
    'timeout_presses_LGA28',
    'inactive_lever_presses_LGA15',
    'inactive_lever_presses_LGA16',
    'inactive_lever_presses_LGA17',
    'inactive_lever_presses_LGA18',
    'inactive_lever_presses_LGA19',
    'inactive_lever_presses_LGA20',
    'inactive_lever_presses_LGA21',
    'inactive_lever_presses_LGA22',
    'inactive_lever_presses_LGA23',
    'inactive_lever_presses_LGA24',
    'inactive_lever_presses_LGA25',
    'inactive_lever_presses_LGA26',
    'inactive_lever_presses_LGA27',
    'inactive_lever_presses_LGA28',
    'von_frey_2_force',
    'von_frey_2_time',
    'von_frey_difference_force',
    'tail_immersion_2_time',
    'tail_immersion_3_time',
    'tail_immersion_difference_tolerance',
    'def_bsl_ave',
    'agg_bsl_ave',
    'total_bsl_ave',
    'def_drug_ave',
    'agg_drug_ave',
    'total_drug_ave',
    'diff_ave_def',
    'diff_ave_agg',
    'diff_ave_total',
    'reward_timestamps_SHA01',
    'reward_timestamps_SHA02',
    'reward_timestamps_SHA03',
    'reward_timestamps_SHA04',
    'reward_timestamps_SHA05',
    'reward_timestamps_SHA06',
    'reward_timestamps_SHA07',
    'reward_timestamps_SHA08',
    'reward_timestamps_SHA09',
    'reward_timestamps_SHA10',
    'active_timestamps_SHA01',
    'active_timestamps_SHA02',
    'active_timestamps_SHA03',
    'active_timestamps_SHA04',
    'active_timestamps_SHA05',
    'active_timestamps_SHA06',
    'active_timestamps_SHA07',
    'active_timestamps_SHA08',
    'active_timestamps_SHA09',
    'active_timestamps_SHA10',
    'timeout_timestamps_SHA01',
    'timeout_timestamps_SHA02',
    'timeout_timestamps_SHA03',
    'timeout_timestamps_SHA04',
    'timeout_timestamps_SHA05',
    'timeout_timestamps_SHA06',
    'timeout_timestamps_SHA07',
    'timeout_timestamps_SHA08',
    'timeout_timestamps_SHA09',
    'timeout_timestamps_SHA10',
    'inactive_timestamps_SHA01',
    'inactive_timestamps_SHA02',
    'inactive_timestamps_SHA03',
    'inactive_timestamps_SHA04',
    'inactive_timestamps_SHA05',
    'inactive_timestamps_SHA06',
    'inactive_timestamps_SHA07',
    'inactive_timestamps_SHA08',
    'inactive_timestamps_SHA09',
    'inactive_timestamps_SHA10',
    'reward_timestamps_LGA01',
    'reward_timestamps_LGA02',
    'reward_timestamps_LGA03',
    'reward_timestamps_LGA04',
    'reward_timestamps_LGA05',
    'reward_timestamps_LGA06',
    'reward_timestamps_LGA07',
    'reward_timestamps_LGA08',
    'reward_timestamps_LGA09',
    'reward_timestamps_LGA10',
    'reward_timestamps_LGA11',
    'reward_timestamps_LGA12',
    'reward_timestamps_LGA13',
    'reward_timestamps_LGA14',
    'active_timestamps_LGA01',
    'active_timestamps_LGA02',
    'active_timestamps_LGA03',
    'active_timestamps_LGA04',
    'active_timestamps_LGA05',
    'active_timestamps_LGA06',
    'active_timestamps_LGA07',
    'active_timestamps_LGA08',
    'active_timestamps_LGA09',
    'active_timestamps_LGA10',
    'active_timestamps_LGA11',
    'active_timestamps_LGA12',
    'active_timestamps_LGA13',
    'active_timestamps_LGA14',
    'timeout_timestamps_LGA01',
    'timeout_timestamps_LGA02',
    'timeout_timestamps_LGA03',
    'timeout_timestamps_LGA04',
    'timeout_timestamps_LGA05',
    'timeout_timestamps_LGA06',
    'timeout_timestamps_LGA07',
    'timeout_timestamps_LGA08',
    'timeout_timestamps_LGA09',
    'timeout_timestamps_LGA10',
    'timeout_timestamps_LGA11',
    'timeout_timestamps_LGA12',
    'timeout_timestamps_LGA13',
    'timeout_timestamps_LGA14',
    'inactive_timestamps_LGA01',
    'inactive_timestamps_LGA02',
    'inactive_timestamps_LGA03',
    'inactive_timestamps_LGA04',
    'inactive_timestamps_LGA05',
    'inactive_timestamps_LGA06',
    'inactive_timestamps_LGA07',
    'inactive_timestamps_LGA08',
    'inactive_timestamps_LGA09',
    'inactive_timestamps_LGA10',
    'inactive_timestamps_LGA11',
    'inactive_timestamps_LGA12',
    'inactive_timestamps_LGA13',
    'inactive_timestamps_LGA14',
    'ratios_PR01',
    'ratios_PR02',
    'ratios_PR03',
    'ratios_TREATMENT01',
    'ratios_TREATMENT02',
    'ratios_TREATMENT03',
    'ratios_TREATMENT04',
    'group_pre_shock',
    'group_shock',
    'rewards_got_shock_PRESHOCK',
    'rewards_got_shock_SHOCK_V1',
    'rewards_got_shock_SHOCK_V2',
    'rewards_got_shock_SHOCK_V3',
    'reward_timestamps_PRESHOCK',
    'reward_timestamps_SHOCK_V1',
    'reward_timestamps_SHOCK_V2',
    'reward_timestamps_SHOCK_V3',
    'reward_timestamps_SHA11',
    'active_timestamps_SHA11',
    'timeout_timestamps_SHA11',
    'inactive_timestamps_SHA11',
    'reward_timestamps_LGA15',
    'reward_timestamps_LGA16',
    'reward_timestamps_LGA17',
    'reward_timestamps_LGA18',
    'reward_timestamps_LGA19',
    'reward_timestamps_LGA20',
    'reward_timestamps_LGA21',
    'reward_timestamps_LGA22',
    'reward_timestamps_LGA23',
    'reward_timestamps_LGA24',
    'reward_timestamps_LGA25',
    'reward_timestamps_LGA26',
    'reward_timestamps_LGA27',
    'reward_timestamps_LGA28',
    'active_timestamps_LGA15',
    'active_timestamps_LGA16',
    'active_timestamps_LGA17',
    'active_timestamps_LGA18',
    'active_timestamps_LGA19',
    'active_timestamps_LGA20',
    'active_timestamps_LGA21',
    'active_timestamps_LGA22',
    'active_timestamps_LGA23',
    'active_timestamps_LGA24',
    'active_timestamps_LGA25',
    'active_timestamps_LGA26',
    'active_timestamps_LGA27',
    'active_timestamps_LGA28',
    'timeout_timestamps_LGA15',
    'timeout_timestamps_LGA16',
    'timeout_timestamps_LGA17',
    'timeout_timestamps_LGA18',
    'timeout_timestamps_LGA19',
    'timeout_timestamps_LGA20',
    'timeout_timestamps_LGA21',
    'timeout_timestamps_LGA22',
    'timeout_timestamps_LGA23',
    'timeout_timestamps_LGA24',
    'timeout_timestamps_LGA25',
    'timeout_timestamps_LGA26',
    'timeout_timestamps_LGA27',
    'timeout_timestamps_LGA28',
    'inactive_timestamps_LGA15',
    'inactive_timestamps_LGA16',
    'inactive_timestamps_LGA17',
    'inactive_timestamps_LGA18',
    'inactive_timestamps_LGA19',
    'inactive_timestamps_LGA20',
    'inactive_timestamps_LGA21',
    'inactive_timestamps_LGA22',
    'inactive_timestamps_LGA23',
    'inactive_timestamps_LGA24',
    'inactive_timestamps_LGA25',
    'inactive_timestamps_LGA26',
    'inactive_timestamps_LGA27',
    'inactive_timestamps_LGA28',
    'vf2_right_force_1',
    'vf2_right_force_2',
    'vf2_right_force_3',
    'vf2_right_force_avg',
    'vf2_right_time_1',
    'vf2_right_time_2',
    'vf2_right_time_3',
    'vf2_right_avg',
    'vf2_left_force_1',
    'vf2_left_force_2',
    'vf2_left_force_3',
    'vf2_left_force_avg',
    'vf2_left_time_1',
    'vf2_left_time_2',
    'vf2_left_time_3',
    'vf2_left_avg',
    'def_bsl_irr_1',
    'agg_bsl_irr_1',
    'irr_bsl_tot_1',
    'def_bsl_irr_2',
    'agg_bsl_irr_2',
    'irr_bsl_total_2',
    'def_bsl_irr_3',
    'agg_bsl_irr_3',
    'irr_bsl_total_3',
    'def_drug_irr_1',
    'agg_drug_irr_1',
    'irr_drug_tot_1',
    'def_drug_irr_2',
    'agg_drug_irr_2',
    'irr_drug_total_2',
    'def_drug_irr_3',
    'agg_drug_irr_3',
    'irr_drug_total_3',
    'measurement_value_feces_1',
    'measurement_value_feces_2',
    'measurement_value_feces_3',
    'measurement_value_feces_4',
    'measurement_value_urine_1',
    'measurement_value_urine_2',
    'measurement_value_weight_1',
    'measurement_value_weight_2',
    'measurement_value_weight_3',
    'measurement_value_weight_4',
    'measurement_value_weight_5',
    'measurement_value_weight_6',
    'measurement_value_weight_7',
    'measurement_value_weight_8',
    'measurement_value_weight_9',
    'measurement_value_weight_10',
    'days_of_experiment',
    'age_at_arrival',
    'age_at_surgery',
    'age_at_sha',
    'age_at_lga',
    'age_at_dissection',
    'dissection_date',
    'date_of_death',
    'exit_day',
    'date_of_birth',
    'date_of_wean',
    'date_of_ship',
    'arrival_date',
    'date_of_eye_bleed',
    'surgery_date',
    'recatheter_surgery_date',
    'short_access_start_date',
    'short_access_end_date',
    'progressive_ratio_1_date',
    'long_access_start_date',
    'long_access_end_date',
    'progressive_ratio_2_date',
    'pre_shock_date',
    'shock_1_date',
    'shock_2_date',
    'shock_3_date',
    'progressive_ratio_3_date',
    'brevital_date',
    'start_time_SHA01',
    'end_time_SHA01',
    'start_time_SHA02',
    'end_time_SHA02',
    'start_time_SHA03',
    'end_time_SHA03',
    'start_time_SHA04',
    'end_time_SHA04',
    'start_time_SHA05',
    'end_time_SHA05',
    'start_time_SHA06',
    'end_time_SHA06',
    'start_time_SHA07',
    'end_time_SHA07',
    'start_time_SHA08',
    'end_time_SHA08',
    'start_time_SHA09',
    'end_time_SHA09',
    'start_time_SHA10',
    'end_time_SHA10',
    'start_time_LGA01',
    'end_time_LGA01',
    'start_time_LGA02',
    'end_time_LGA02',
    'start_time_LGA03',
    'end_time_LGA03',
    'start_time_LGA04',
    'end_time_LGA04',
    'start_time_LGA05',
    'end_time_LGA05',
    'start_time_LGA06',
    'end_time_LGA06',
    'start_time_LGA07',
    'end_time_LGA07',
    'start_time_LGA08',
    'end_time_LGA08',
    'start_time_LGA09',
    'end_time_LGA09',
    'start_time_LGA10',
    'end_time_LGA10',
    'start_time_LGA11',
    'end_time_LGA11',
    'start_time_LGA12',
    'end_time_LGA12',
    'start_time_LGA13',
    'end_time_LGA13',
    'start_time_LGA14',
    'end_time_LGA14',
    'start_time_PR01',
    'end_time_PR01',
    'start_time_PR02',
    'end_time_PR02',
    'start_time_PR03',
    'end_time_PR03',
    'lga_post_treatment_1_date',
    'lga_post_treatment_2_date',
    'lga_post_treatment_3_date',
    'lga_post_treatment_4_date',
    'treatment_1_start_time',
    'treatment_2_start_time',
    'treatment_3_start_time',
    'treatment_4_start_time',
    'start_time_TREATMENT01',
    'end_time_TREATMENT01', 
    'start_time_TREATMENT02',
    'end_time_TREATMENT02',
    'start_time_TREATMENT03',
    'end_time_TREATMENT03',
    'start_time_TREATMENT04',
    'end_time_TREATMENT04',
    'start_time_PRESHOCK',
    'end_time_PRESHOCK',
    'start_time_SHOCK_V1',
    'end_time_SHOCK_V1',
    'start_time_SHOCK_V2',
    'end_time_SHOCK_V2',
    'start_time_SHOCK_V3',
    'end_time_SHOCK_V3',
    'start_time_SHA11',
    'end_time_SHA11',
    'start_time_LGA15',
    'end_time_LGA15',
    'start_time_LGA16',
    'end_time_LGA16',
    'start_time_LGA17',
    'end_time_LGA17',
    'start_time_LGA18',
    'end_time_LGA18',
    'start_time_LGA19',
    'end_time_LGA19',
    'start_time_LGA20',
    'end_time_LGA20',
    'start_time_LGA21',
    'end_time_LGA21',
    'start_time_LGA22',
    'end_time_LGA22',
    'start_time_LGA23',
    'end_time_LGA23',
    'start_time_LGA24',
    'end_time_LGA24',
    'start_time_LGA25',
    'end_time_LGA25',
    'start_time_LGA26',
    'end_time_LGA26',
    'start_time_LGA27',
    'end_time_LGA27',
    'start_time_LGA28',
    'end_time_LGA28',
    'treatment_1_date',
    'treatment_2_date',
    'treatment_3_date',
    'treatment_4_date',
    'von_frey_2_date',
    'tail_immersion_2_date',
    'tail_immersion_3_date',
    'irritability_1_date',
    'irritability_2_date',
    'female_swab_1_date',
    'female_swab_2_date',
    'female_swab_3_date',
    'lga_pre_treatment_1_date',
    'lga_pre_treatment_2_date',
    'lga_pre_treatment_3_date',
    'lga_pre_treatment_4_date',
    'lga_15_date',
    'lga_16_date',
    'lga_17_date',
    'lga_18_date',
    'lga_19_date',
    'lga_20_date',
    'handled_by',
    'surgeon',
    'surgery_assist',
    'recatheter_surgeon',
    'brevital_technicians',
    'irr_bsl_scorer_1',
    'irr_bsl_scorer_2',
    'irr_bsl_scorer_3',
    'irr_drug_scorer_1',
    'irr_drug_scorer_2',
    'irr_drug_scorer_3',
    'irritability_1_technicians',
    'irritability_2_technicians',
    'von_frey_2_technicians',
    'tail_immersion_2_technicians',
    'tail_immersion_3_technicians',
    'female_swab_1_technicians',
    'female_swab_2_technicians',
    'female_swab_3_technicians',
    'technician_urine_1',
    'technician_urine_2',
    'technician_feces_1',
    'technician_feces_2',
    'technician_feces_3',
    'technician_feces_4',
    'technician_weight_1',
    'technician_weight_2',
    'technician_weight_3',
    'technician_weight_4',
    'technician_weight_5',
    'technician_weight_6',
    'technician_weight_7',
    'technician_weight_8',
    'technician_weight_9',
    'technician_weight_10']
oxy_fail_comp_cols = ['female_swab_1_analysis',
    'female_swab_2_analysis',
    'female_swab_3_analysis',
    'reward_presses_PR03',
    'active_lever_presses_PR03',
    'inactive_lever_presses_PR03',
    'breakpoint_PR01',
    'breakpoint_PR02',
    'breakpoint_PR03',
    'last_ratio_PR01',
    'last_ratio_PR02',
    'last_ratio_PR03',
    'treatment_1_group',
    'treatment_2_group',
    'treatment_3_group',
    'treatment_4_group',
    'reward_presses_TREATMENT01',
    'reward_presses_TREATMENT02',
    'reward_presses_TREATMENT03',
    'reward_presses_TREATMENT04',
    'active_lever_presses_TREATMENT01',
    'active_lever_presses_TREATMENT02',
    'active_lever_presses_TREATMENT03',
    'active_lever_presses_TREATMENT04',
    'inactive_lever_presses_TREATMENT01',
    'inactive_lever_presses_TREATMENT02',
    'inactive_lever_presses_TREATMENT03',
    'inactive_lever_presses_TREATMENT04',
    'breakpoint_TREATMENT01',
    'breakpoint_TREATMENT02',
    'breakpoint_TREATMENT03',
    'breakpoint_TREATMENT04',
    'last_ratio_TREATMENT01',
    'last_ratio_TREATMENT02',
    'last_ratio_TREATMENT03',
    'last_ratio_TREATMENT04',
    'total_reward_PRESHOCK',
    'total_reward_SHOCK_V1',
    'total_reward_SHOCK_V2',
    'total_reward_SHOCK_V3',
    'total_active_lever_presses_PRESHOCK',
    'total_active_lever_presses_SHOCK_V1',
    'total_active_lever_presses_SHOCK_V2',
    'total_active_lever_presses_SHOCK_V3',
    'total_inactive_lever_presses_PRESHOCK',
    'total_inactive_lever_presses_SHOCK_V1',
    'total_inactive_lever_presses_SHOCK_V2',
    'total_inactive_lever_presses_SHOCK_V3',
    'total_shocks_PRESHOCK',
    'total_shocks_SHOCK_V1',
    'total_shocks_SHOCK_V2',
    'total_shocks_SHOCK_V3',
    'rewards_after_first_shock_PRESHOCK',
    'rewards_after_first_shock_SHOCK_V1',
    'rewards_after_first_shock_SHOCK_V2',
    'rewards_after_first_shock_SHOCK_V3',
    'reward_presses_SHA11',
    'active_lever_presses_SHA11',
    'timeout_presses_SHA11',
    'inactive_lever_presses_SHA11',
    'reward_presses_LGA15',
    'reward_presses_LGA16',
    'reward_presses_LGA17',
    'reward_presses_LGA18',
    'reward_presses_LGA19',
    'reward_presses_LGA20',
    'reward_presses_LGA21',
    'reward_presses_LGA22',
    'reward_presses_LGA23',
    'reward_presses_LGA24',
    'reward_presses_LGA25',
    'reward_presses_LGA26',
    'reward_presses_LGA27',
    'reward_presses_LGA28',
    'active_lever_presses_LGA15',
    'active_lever_presses_LGA16',
    'active_lever_presses_LGA17',
    'active_lever_presses_LGA18',
    'active_lever_presses_LGA19',
    'active_lever_presses_LGA20',
    'active_lever_presses_LGA21',
    'active_lever_presses_LGA22',
    'active_lever_presses_LGA23',
    'active_lever_presses_LGA24',
    'active_lever_presses_LGA25',
    'active_lever_presses_LGA26',
    'active_lever_presses_LGA27',
    'active_lever_presses_LGA28',
    'timeout_presses_LGA15',
    'timeout_presses_LGA16',
    'timeout_presses_LGA17',
    'timeout_presses_LGA18',
    'timeout_presses_LGA19',
    'timeout_presses_LGA20',
    'timeout_presses_LGA21',
    'timeout_presses_LGA22',
    'timeout_presses_LGA23',
    'timeout_presses_LGA24',
    'timeout_presses_LGA25',
    'timeout_presses_LGA26',
    'timeout_presses_LGA27',
    'timeout_presses_LGA28',
    'inactive_lever_presses_LGA15',
    'inactive_lever_presses_LGA16',
    'inactive_lever_presses_LGA17',
    'inactive_lever_presses_LGA18',
    'inactive_lever_presses_LGA19',
    'inactive_lever_presses_LGA20',
    'inactive_lever_presses_LGA21',
    'inactive_lever_presses_LGA22',
    'inactive_lever_presses_LGA23',
    'inactive_lever_presses_LGA24',
    'inactive_lever_presses_LGA25',
    'inactive_lever_presses_LGA26',
    'inactive_lever_presses_LGA27',
    'inactive_lever_presses_LGA28',
    'von_frey_1_force',
    'von_frey_1_time',
    'von_frey_2_force',
    'von_frey_2_time',
    'von_frey_difference_force',
    'tail_immersion_1_time',
    'tail_immersion_2_time',
    'tail_immersion_3_time',
    'tail_immersion_difference_tolerance',
    'def_bsl_ave',
    'agg_bsl_ave',
    'total_bsl_ave',
    'def_drug_ave',
    'agg_drug_ave',
    'total_drug_ave',
    'diff_ave_def',
    'diff_ave_agg',
    'diff_ave_total',
    'ratios_PR03',
    'ratios_TREATMENT01',
    'ratios_TREATMENT02',
    'ratios_TREATMENT03',
    'ratios_TREATMENT04',
    'group_pre_shock',
    'group_shock',
    'rewards_got_shock_PRESHOCK',
    'rewards_got_shock_SHOCK_V1',
    'rewards_got_shock_SHOCK_V2',
    'rewards_got_shock_SHOCK_V3',
    'reward_timestamps_PRESHOCK',
    'reward_timestamps_SHOCK_V1',
    'reward_timestamps_SHOCK_V2',
    'reward_timestamps_SHOCK_V3',
    'reward_timestamps_SHA11',
    'active_timestamps_SHA11',
    'timeout_timestamps_SHA11',
    'inactive_timestamps_SHA11',
    'reward_timestamps_LGA15',
    'reward_timestamps_LGA16',
    'reward_timestamps_LGA17',
    'reward_timestamps_LGA18',
    'reward_timestamps_LGA19',
    'reward_timestamps_LGA20',
    'reward_timestamps_LGA21',
    'reward_timestamps_LGA22',
    'reward_timestamps_LGA23',
    'reward_timestamps_LGA24',
    'reward_timestamps_LGA25',
    'reward_timestamps_LGA26',
    'reward_timestamps_LGA27',
    'reward_timestamps_LGA28',
    'active_timestamps_LGA15',
    'active_timestamps_LGA16',
    'active_timestamps_LGA17',
    'active_timestamps_LGA18',
    'active_timestamps_LGA19',
    'active_timestamps_LGA20',
    'active_timestamps_LGA21',
    'active_timestamps_LGA22',
    'active_timestamps_LGA23',
    'active_timestamps_LGA24',
    'active_timestamps_LGA25',
    'active_timestamps_LGA26',
    'active_timestamps_LGA27',
    'active_timestamps_LGA28',
    'timeout_timestamps_LGA15',
    'timeout_timestamps_LGA16',
    'timeout_timestamps_LGA17',
    'timeout_timestamps_LGA18',
    'timeout_timestamps_LGA19',
    'timeout_timestamps_LGA20',
    'timeout_timestamps_LGA21',
    'timeout_timestamps_LGA22',
    'timeout_timestamps_LGA23',
    'timeout_timestamps_LGA24',
    'timeout_timestamps_LGA25',
    'timeout_timestamps_LGA26',
    'timeout_timestamps_LGA27',
    'timeout_timestamps_LGA28',
    'inactive_timestamps_LGA15',
    'inactive_timestamps_LGA16',
    'inactive_timestamps_LGA17',
    'inactive_timestamps_LGA18',
    'inactive_timestamps_LGA19',
    'inactive_timestamps_LGA20',
    'inactive_timestamps_LGA21',
    'inactive_timestamps_LGA22',
    'inactive_timestamps_LGA23',
    'inactive_timestamps_LGA24',
    'inactive_timestamps_LGA25',
    'inactive_timestamps_LGA26',
    'inactive_timestamps_LGA27',
    'inactive_timestamps_LGA28',
    'vf1_right_force_1',
    'vf1_right_force_2',
    'vf1_right_force_3',
    'vf1_right_force_avg',
    'vf1_right_time_1',
    'vf1_right_time_2',
    'vf1_right_time_3',
    'vf1_right_avg',
    'vf1_left_force_1',
    'vf1_left_force_2',
    'vf1_left_force_3',
    'vf1_left_force_avg',
    'vf1_left_time_1',
    'vf1_left_time_2',
    'vf1_left_time_3',
    'vf1_left_avg',
    'vf2_right_force_1',
    'vf2_right_force_2',
    'vf2_right_force_3',
    'vf2_right_force_avg',
    'vf2_right_time_1',
    'vf2_right_time_2',
    'vf2_right_time_3',
    'vf2_right_avg',
    'vf2_left_force_1',
    'vf2_left_force_2',
    'vf2_left_force_3',
    'vf2_left_force_avg',
    'vf2_left_time_1',
    'vf2_left_time_2',
    'vf2_left_time_3',
    'vf2_left_avg',
    'def_bsl_irr_1',
    'agg_bsl_irr_1',
    'irr_bsl_tot_1',
    'def_bsl_irr_2',
    'agg_bsl_irr_2',
    'irr_bsl_total_2',
    'def_bsl_irr_3',
    'agg_bsl_irr_3',
    'irr_bsl_total_3',
    'def_drug_irr_1',
    'agg_drug_irr_1',
    'irr_drug_tot_1',
    'def_drug_irr_2',
    'agg_drug_irr_2',
    'irr_drug_total_2',
    'def_drug_irr_3',
    'agg_drug_irr_3',
    'irr_drug_total_3',
    'measurement_value_feces_1',
    'measurement_value_feces_2',
    'measurement_value_feces_3',
    'measurement_value_feces_4',
    'measurement_value_urine_1',
    'measurement_value_urine_2',
    'measurement_value_weight_1',
    'measurement_value_weight_2',
    'measurement_value_weight_3',
    'measurement_value_weight_4',
    'measurement_value_weight_5',
    'measurement_value_weight_6',
    'measurement_value_weight_7',
    'measurement_value_weight_8',
    'measurement_value_weight_9',
    'measurement_value_weight_10',
    'days_of_experiment',
    'age_at_arrival',
    'age_at_surgery',
    'age_at_sha',
    'age_at_lga',
    'age_at_dissection',
    'dissection_date',
    'date_of_death',
    'exit_day',
    'date_of_birth',
    'date_of_wean',
    'date_of_ship',
    'arrival_date',
    'date_of_eye_bleed',
    'surgery_date',
    'recatheter_surgery_date',
    'short_access_start_date',
    'short_access_end_date',
    'long_access_start_date',
    'long_access_end_date',
    'pre_shock_date',
    'shock_1_date',
    'shock_2_date',
    'shock_3_date',
    'progressive_ratio_3_date',
    'brevital_date',
    'start_time_PR03',
    'end_time_PR03',
    'lga_post_treatment_1_date',
    'lga_post_treatment_2_date',
    'lga_post_treatment_3_date',
    'lga_post_treatment_4_date',
    'treatment_1_start_time',
    'treatment_2_start_time',
    'treatment_3_start_time',
    'treatment_4_start_time',
    'start_time_TREATMENT01',
    'end_time_TREATMENT01', 
    'start_time_TREATMENT02',
    'end_time_TREATMENT02',
    'start_time_TREATMENT03',
    'end_time_TREATMENT03',
    'start_time_TREATMENT04',
    'end_time_TREATMENT04',
    'start_time_PRESHOCK',
    'end_time_PRESHOCK',
    'start_time_SHOCK_V1',
    'end_time_SHOCK_V1',
    'start_time_SHOCK_V2',
    'end_time_SHOCK_V2',
    'start_time_SHOCK_V3',
    'end_time_SHOCK_V3',
    'start_time_SHA11',
    'end_time_SHA11',
    'start_time_LGA15',
    'end_time_LGA15',
    'start_time_LGA16',
    'end_time_LGA16',
    'start_time_LGA17',
    'end_time_LGA17',
    'start_time_LGA18',
    'end_time_LGA18',
    'start_time_LGA19',
    'end_time_LGA19',
    'start_time_LGA20',
    'end_time_LGA20',
    'start_time_LGA21',
    'end_time_LGA21',
    'start_time_LGA22',
    'end_time_LGA22',
    'start_time_LGA23',
    'end_time_LGA23',
    'start_time_LGA24',
    'end_time_LGA24',
    'start_time_LGA25',
    'end_time_LGA25',
    'start_time_LGA26',
    'end_time_LGA26',
    'start_time_LGA27',
    'end_time_LGA27',
    'start_time_LGA28',
    'end_time_LGA28',
    'treatment_1_date',
    'treatment_2_date',
    'treatment_3_date',
    'treatment_4_date',
    'von_frey_1_date',
    'von_frey_2_date',
    'tail_immersion_1_date',
    'tail_immersion_2_date',
    'tail_immersion_3_date',
    'irritability_1_date',
    'irritability_2_date',
    'female_swab_1_date',
    'female_swab_2_date',
    'female_swab_3_date',
    'lga_pre_treatment_1_date',
    'lga_pre_treatment_2_date',
    'lga_pre_treatment_3_date',
    'lga_pre_treatment_4_date',
    'lga_15_date',
    'lga_16_date',
    'lga_17_date',
    'lga_18_date',
    'lga_19_date',
    'lga_20_date',
    'handled_by',
    'surgeon',
    'surgery_assist',
    'recatheter_surgeon',
    'brevital_technicians',
    'irr_bsl_scorer_1',
    'irr_bsl_scorer_2',
    'irr_bsl_scorer_3',
    'irr_drug_scorer_1',
    'irr_drug_scorer_2',
    'irr_drug_scorer_3',
    'irritability_1_technicians',
    'irritability_2_technicians',
    'von_frey_1_technicians',
    'von_frey_2_technicians',
    'tail_immersion_1_technicians',
    'tail_immersion_2_technicians',
    'tail_immersion_3_technicians',
    'female_swab_1_technicians',
    'female_swab_2_technicians',
    'female_swab_3_technicians',
    'technician_urine_1',
    'technician_urine_2',
    'technician_feces_1',
    'technician_feces_2',
    'technician_feces_3',
    'technician_feces_4',
    'technician_weight_1',
    'technician_weight_2',
    'technician_weight_3',
    'technician_weight_4',
    'technician_weight_5',
    'technician_weight_6',
    'technician_weight_7',
    'technician_weight_8',
    'technician_weight_9',
    'technician_weight_10']

# COMMAND ----------

#this is older version of code where it just removed all brevital failed ones
"""
rows = []
test = test[ordered_cols]
for i,row in test.iterrows():
    curr_cols = []
    if type(row['exit_code']) == str and 'brevital fail' in row['exit_code'].lower():
        if row['drug_group'] == 'Cocaine':
            if type(row['complete']) == str and 'no' in row['complete'].lower():
                curr_cols = coc_fail_noncomp_cols
            else:
                curr_cols = coc_fail_comp_cols
        elif row['drug_group'] == 'Oxycodone':
            if type(row['complete']) == str and 'no' in row['complete'].lower():
                curr_cols = oxy_fail_noncomp_cols
            else:
                curr_cols = oxy_fail_comp_cols
    for col in curr_cols:
        row[col] = None
    rows.append(row)
    """

        

# COMMAND ----------

orders_coc = {
    'Irritability 1':{'order':0,'date': 'irritability_1_date', 'items':['def_bsl_irr_1', 'agg_bsl_1', 'irr_bs1_tot_1','def_drugl_irr_1', 'agg_drug_1', 'irr_drug_tot_1']},
    'SHA01':{'order':1,'date': 'short_access_start_date', 'items':['reward_presses_SHA01','active_lever_presses_SHA01','timeout_presses_SHA01','inactive_lever_presses_SHA01','reward_timestamps_SHA01','active_timestamps_SHA01','timeout_timestamps_SHA01','inactive_timestamps_SHA01']},
    'SHA02':{'order':2,'date': 'short_access_start_date', 'items':['reward_presses_SHA02','active_lever_presses_SHA02','timeout_presses_SHA02','inactive_lever_presses_SHA02','reward_timestamps_SHA02','active_timestamps_SHA02','timeout_timestamps_SHA02','inactive_timestamps_SHA02']},
    'SHA03':{'order':3,'date': 'short_access_start_date', 'items':['reward_presses_SHA03','active_lever_presses_SHA03','timeout_presses_SHA03','inactive_lever_presses_SHA03','reward_timestamps_SHA03','active_timestamps_SHA03','timeout_timestamps_SHA03','inactive_timestamps_SHA03']},
    'SHA04':{'order':4,'date': 'short_access_start_date', 'items':['reward_presses_SHA04','active_lever_presses_SHA04','timeout_presses_SHA04','inactive_lever_presses_SHA04','reward_timestamps_SHA04','active_timestamps_SHA04','timeout_timestamps_SHA04','inactive_timestamps_SHA04']},
    'SHA05':{'order':5,'date': 'short_access_start_date', 'items':['reward_presses_SHA05','active_lever_presses_SHA05','timeout_presses_SHA05','inactive_lever_presses_SHA05','reward_timestamps_SHA05','active_timestamps_SHA05','timeout_timestamps_SHA05','inactive_timestamps_SHA05']},
    'SHA06':{'order':6,'date': 'short_access_start_date', 'items':['reward_presses_SHA06','active_lever_presses_SHA06','timeout_presses_SHA06','inactive_lever_presses_SHA06','reward_timestamps_SHA06','active_timestamps_SHA06','timeout_timestamps_SHA06','inactive_timestamps_SHA06']},
    'SHA07':{'order':7,'date': 'short_access_start_date', 'items':['reward_presses_SHA07','active_lever_presses_SHA07','timeout_presses_SHA07','inactive_lever_presses_SHA07','reward_timestamps_SHA07','active_timestamps_SHA07','timeout_timestamps_SHA07','inactive_timestamps_SHA07']},
    'SHA08':{'order':8,'date': 'short_access_start_date', 'items':['reward_presses_SHA08','active_lever_presses_SHA08','timeout_presses_SHA08','inactive_lever_presses_SHA08','reward_timestamps_SHA08','active_timestamps_SHA08','timeout_timestamps_SHA08','inactive_timestamps_SHA08']},
    'SHA09':{'order':9,'date': 'short_access_start_date', 'items':['reward_presses_SHA09','active_lever_presses_SHA09','timeout_presses_SHA09','inactive_lever_presses_SHA09','reward_timestamps_SHA09','active_timestamps_SHA09','timeout_timestamps_SHA09','inactive_timestamps_SHA09']},
    'SHA10':{'order':10,'date': 'short_access_start_date', 'items':['reward_presses_SHA10','active_lever_presses_SHA10','timeout_presses_SHA10','inactive_lever_presses_SHA10','reward_timestamps_SHA10','active_timestamps_SHA10','timeout_timestamps_SHA10','inactive_timestamps_SHA10']},
    'PR1':{'order':11,'date': 'progressive_ratio_1_date', 'items':['reward_presses_PR01','active_lever_presses_PR01','inactive_lever_presses_PR01','breakpoint_PR01','last_ratio_PR01','ratios_PR01']},
    'LGA01':{'order':12,'date': 'long_access_start_date', 'items':['reward_presses_LGA01','active_lever_presses_LGA01','timeout_presses_LGA01','inactive_lever_presses_LGA01','reward_timestamps_LGA01','active_timestamps_LGA01','timeout_timestamps_LGA01','inactive_timestamps_LGA01']},
    'LGA02':{'order':13,'date': 'long_access_start_date', 'items':['reward_presses_LGA02','active_lever_presses_LGA02','timeout_presses_LGA02','inactive_lever_presses_LGA02','reward_timestamps_LGA02','active_timestamps_LGA02','timeout_timestamps_LGA02','inactive_timestamps_LGA02']},
    'LGA03':{'order':14,'date': 'long_access_start_date', 'items':['reward_presses_LGA03','active_lever_presses_LGA03','timeout_presses_LGA03','inactive_lever_presses_LGA03','reward_timestamps_LGA03','active_timestamps_LGA03','timeout_timestamps_LGA03','inactive_timestamps_LGA03']},
    'LGA04':{'order':15,'date': 'long_access_start_date', 'items':['reward_presses_LGA04','active_lever_presses_LGA04','timeout_presses_LGA04','inactive_lever_presses_LGA04','reward_timestamps_LGA04','active_timestamps_LGA04','timeout_timestamps_LGA04','inactive_timestamps_LGA04']},
    'LGA05':{'order':16,'date': 'long_access_start_date', 'items':['reward_presses_LGA05','active_lever_presses_LGA05','timeout_presses_LGA05','inactive_lever_presses_LGA05','reward_timestamps_LGA05','active_timestamps_LGA05','timeout_timestamps_LGA05','inactive_timestamps_LGA05']},
    'LGA06':{'order':17,'date': 'long_access_start_date', 'items':['reward_presses_LGA06','active_lever_presses_LGA06','timeout_presses_LGA06','inactive_lever_presses_LGA06','reward_timestamps_LGA06','active_timestamps_LGA06','timeout_timestamps_LGA06','inactive_timestamps_LGA06']},
    'LGA07':{'order':18,'date': 'long_access_start_date', 'items':['reward_presses_LGA07','active_lever_presses_LGA07','timeout_presses_LGA07','inactive_lever_presses_LGA07','reward_timestamps_LGA07','active_timestamps_LGA07','timeout_timestamps_LGA07','inactive_timestamps_LGA07']},
    'LGA08':{'order':19,'date': 'long_access_start_date', 'items':['reward_presses_LGA08','active_lever_presses_LGA08','timeout_presses_LGA08','inactive_lever_presses_LGA08','reward_timestamps_LGA08','active_timestamps_LGA08','timeout_timestamps_LGA08','inactive_timestamps_LGA08']},
    'LGA09':{'order':20,'date': 'long_access_start_date', 'items':['reward_presses_LGA09','active_lever_presses_LGA09','timeout_presses_LGA09','inactive_lever_presses_LGA09','reward_timestamps_LGA09','active_timestamps_LGA09','timeout_timestamps_LGA09','inactive_timestamps_LGA09']},
    'LGA10':{'order':21,'date': 'long_access_start_date', 'items':['reward_presses_LGA10','active_lever_presses_LGA10','timeout_presses_LGA10','inactive_lever_presses_LGA10','reward_timestamps_LGA10','active_timestamps_LGA10','timeout_timestamps_LGA10','inactive_timestamps_LGA10']},
    'LGA11':{'order':22,'date': 'long_access_start_date', 'items':['reward_presses_LGA11','active_lever_presses_LGA11','timeout_presses_LGA11','inactive_lever_presses_LGA11','reward_timestamps_LGA11','active_timestamps_LGA11','timeout_timestamps_LGA11','inactive_timestamps_LGA11']},
    'LGA12':{'order':23,'date': 'long_access_start_date', 'items':['reward_presses_LGA12','active_lever_presses_LGA12','timeout_presses_LGA12','inactive_lever_presses_LGA12','reward_timestamps_LGA12','active_timestamps_LGA12','timeout_timestamps_LGA12','inactive_timestamps_LGA12']},
    'LGA13':{'order':24,'date': 'long_access_start_date', 'items':['reward_presses_LGA13','active_lever_presses_LGA13','timeout_presses_LGA13','inactive_lever_presses_LGA13','reward_timestamps_LGA13','active_timestamps_LGA13','timeout_timestamps_LGA13','inactive_timestamps_LGA13']},
    'LGA14':{'order':25,'date': 'long_access_start_date', 'items':['reward_presses_LGA14','active_lever_presses_LGA14','timeout_presses_LGA14','inactive_lever_presses_LGA14','reward_timestamps_LGA14','active_timestamps_LGA14','timeout_timestamps_LGA14','inactive_timestamps_LGA14']},
    'LGA15':{'order':21,'date': 'lga_15_date', 'items':['reward_presses_LGA15','active_lever_presses_LGA15','timeout_presses_LGA15','inactive_lever_presses_LGA15','reward_timestamps_LGA15','active_timestamps_LGA15','timeout_timestamps_LGA15','inactive_timestamps_LGA15']},
    'LGA16':{'order':21,'date': 'lga_16_date', 'items':['reward_presses_LGA16','active_lever_presses_LGA16','timeout_presses_LGA16','inactive_lever_presses_LGA16','reward_timestamps_LGA16','active_timestamps_LGA16','timeout_timestamps_LGA16','inactive_timestamps_LGA16']},
    'LGA17':{'order':21,'date': 'lga_17_date', 'items':['reward_presses_LGA17','active_lever_presses_LGA17','timeout_presses_LGA17','inactive_lever_presses_LGA17','reward_timestamps_LGA17','active_timestamps_LGA17','timeout_timestamps_LGA17','inactive_timestamps_LGA17']},
    'LGA18':{'order':21,'date': 'lga_18_date', 'items':['reward_presses_LGA18','active_lever_presses_LGA18','timeout_presses_LGA18','inactive_lever_presses_LGA18','reward_timestamps_LGA18','active_timestamps_LGA18','timeout_timestamps_LGA18','inactive_timestamps_LGA18']},
    'LGA19':{'order':21,'date': 'lga_19_date', 'items':['reward_presses_LGA14','active_lever_presses_LGA14','timeout_presses_LGA14','inactive_lever_presses_LGA19','reward_timestamps_LGA19','active_timestamps_LGA19','timeout_timestamps_LGA19','inactive_timestamps_LGA19']},
    'LGA20':{'order':21,'date': 'lga_20_date', 'items':['reward_presses_LGA20','active_lever_presses_LGA20','timeout_presses_LGA20','inactive_lever_presses_LGA20','reward_timestamps_LGA20','active_timestamps_LGA20','timeout_timestamps_LGA20','inactive_timestamps_LGA20']},
    'Irritability 2':{'order':26,'date': 'irritability_1_date', 'items':['def_bsl_irr_2', 'agg_bsl_2', 'irr_bs1_tot_2','def_drugl_irr_2', 'agg_drug_2', 'irr_drug_tot_2']},
    'PR02': {'order':27,'date':'progressive_ratio_2_date' , 'items':['reward_presses_PR02','active_lever_presses_PR02','inactive_lever_presses_PR02','breakpoint_PR02','last_ratio_PR02','ratios_PR02']},
    'PRESHOCK':{'order':28,'date': 'pre_shock_date', 'items':['total_reward_PRESHOCK','total_active_lever_presses_PRESHOCK','total_inactive_lever_presses_PRESHOCK','total_shocks_PRESHOCK','rewards_after_first_shock_PRESHOCK','rewards_got_shock_PRESHOCK','reward_timestamps_PRESHOCK']},
    'SHOCK01':{'order':29,'date': 'shock_1_date', 'items':['total_reward_SHOCK_V1','total_active_lever_presses_SHOCK_V1','total_inactive_lever_presses_SHOCK_V1','total_shocks_SHOCK_V1','rewards_after_first_shock_SHOCK_V1','rewards_got_shock_SHOCK_V1','reward_timestamps_SHOCK_V1']},
    'SHOCK02':{'order':30,'date': 'shock_2_date', 'items':['total_reward_SHOCK_V2','total_active_lever_presses_SHOCK_V2','total_inactive_lever_presses_SHOCK_V2','total_shocks_SHOCK_V2','rewards_after_first_shock_SHOCK_V2','rewards_got_shock_SHOCK_V2','reward_timestamps_SHOCK_V2']},
    'SHOCK03':{'order':31,'date': 'shock_3_date', 'items':['total_reward_SHOCK_V2','total_active_lever_presses_SHOCK_V2','total_inactive_lever_presses_SHOCK_V2','total_shocks_SHOCK_V2','rewards_after_first_shock_SHOCK_V2','rewards_got_shock_SHOCK_V2','reward_timestamps_SHOCK_V2']},
    'PR03':{'order':32,'date': 'progressive_ratio_3_date', 'items':['reward_presses_PR03','active_lever_presses_PR03','inactive_lever_presses_PR03','breakpoint_PR03','last_ratio_PR03','ratios_PR03']}
}
orders_oxy = {
    'Von Frey 1':{'order':0,'date': 'von_frey_1_date', 'items':['von_frey_1_force','von_frey_1_time','vf1_right_force_1','vf1_right_time_1','vf1_left_force_1','vf1_left_time_1','vf1_right_force_2','vf1_right_time_2','vf1_left_force_2','vf1_left_time_2','vf1_right_force_3','vf1_right_time_3','vf1_left_force_3','vf1_left_time_3','vf1_right_force_avg','vf1_right_time_avg','vf1_left_force_avg','vf1_left_time_avg']},
    'Tail Immersion 1':{'order':1,'date': 'tail_immersion_1_date', 'items':['tail_immersion_1_time',]},
    'Tail Immersion 2':{'order':2,'date': 'tail_immersion_2_date', 'items':['tail_immersion_2_time',]},
    'SHA01':{'order':3,'date': 'short_access_start_date', 'items':['reward_presses_SHA01','active_lever_presses_SHA01','timeout_presses_SHA01','inactive_lever_presses_SHA01','reward_timestamps_SHA01','active_timestamps_SHA01','timeout_timestamps_SHA01','inactive_timestamps_SHA01']},
    'SHA02':{'order':4,'date': 'short_access_start_date', 'items':['reward_presses_SHA02','active_lever_presses_SHA02','timeout_presses_SHA02','inactive_lever_presses_SHA02','reward_timestamps_SHA02','active_timestamps_SHA02','timeout_timestamps_SHA02','inactive_timestamps_SHA02']},
    'SHA03':{'order':5,'date': 'short_access_start_date', 'items':['reward_presses_SHA03','active_lever_presses_SHA03','timeout_presses_SHA03','inactive_lever_presses_SHA03','reward_timestamps_SHA03','active_timestamps_SHA03','timeout_timestamps_SHA03','inactive_timestamps_SHA03']},
    'SHA04':{'order':6,'date': 'short_access_start_date', 'items':['reward_presses_SHA04','active_lever_presses_SHA04','timeout_presses_SHA04','inactive_lever_presses_SHA04','reward_timestamps_SHA04','active_timestamps_SHA04','timeout_timestamps_SHA04','inactive_timestamps_SHA04']},
    'PR1':{'order':7,'date': 'progressive_ratio_1_date', 'items':['reward_presses_PR01','active_lever_presses_PR01','inactive_lever_presses_PR01','breakpoint_PR01','last_ratio_PR01','ratios_PR01']},
    'LGA01':{'order':8,'date': 'long_access_start_date', 'items':['reward_presses_LGA01','active_lever_presses_LGA01','timeout_presses_LGA01','inactive_lever_presses_LGA01','reward_timestamps_LGA01','active_timestamps_LGA01','timeout_timestamps_LGA01','inactive_timestamps_LGA01']},
    'LGA02':{'order':9,'date': 'long_access_start_date', 'items':['reward_presses_LGA02','active_lever_presses_LGA02','timeout_presses_LGA02','inactive_lever_presses_LGA02','reward_timestamps_LGA02','active_timestamps_LGA02','timeout_timestamps_LGA02','inactive_timestamps_LGA02']},
    'LGA03':{'order':10,'date': 'long_access_start_date', 'items':['reward_presses_LGA03','active_lever_presses_LGA03','timeout_presses_LGA03','inactive_lever_presses_LGA03','reward_timestamps_LGA03','active_timestamps_LGA03','timeout_timestamps_LGA03','inactive_timestamps_LGA03']},
    'LGA04':{'order':11,'date': 'long_access_start_date', 'items':['reward_presses_LGA04','active_lever_presses_LGA04','timeout_presses_LGA04','inactive_lever_presses_LGA04','reward_timestamps_LGA04','active_timestamps_LGA04','timeout_timestamps_LGA04','inactive_timestamps_LGA04']},
    'LGA05':{'order':12,'date': 'long_access_start_date', 'items':['reward_presses_LGA05','active_lever_presses_LGA05','timeout_presses_LGA05','inactive_lever_presses_LGA05','reward_timestamps_LGA05','active_timestamps_LGA05','timeout_timestamps_LGA05','inactive_timestamps_LGA05']},
    'LGA06':{'order':13,'date': 'long_access_start_date', 'items':['reward_presses_LGA06','active_lever_presses_LGA06','timeout_presses_LGA06','inactive_lever_presses_LGA06','reward_timestamps_LGA06','active_timestamps_LGA06','timeout_timestamps_LGA06','inactive_timestamps_LGA06']},
    'LGA07':{'order':14,'date': 'long_access_start_date', 'items':['reward_presses_LGA07','active_lever_presses_LGA07','timeout_presses_LGA07','inactive_lever_presses_LGA07','reward_timestamps_LGA07','active_timestamps_LGA07','timeout_timestamps_LGA07','inactive_timestamps_LGA07']},
    'LGA08':{'order':15,'date': 'long_access_start_date', 'items':['reward_presses_LGA08','active_lever_presses_LGA08','timeout_presses_LGA08','inactive_lever_presses_LGA08','reward_timestamps_LGA08','active_timestamps_LGA08','timeout_timestamps_LGA08','inactive_timestamps_LGA08']},
    'LGA09':{'order':16,'date': 'long_access_start_date', 'items':['reward_presses_LGA09','active_lever_presses_LGA09','timeout_presses_LGA09','inactive_lever_presses_LGA09','reward_timestamps_LGA09','active_timestamps_LGA09','timeout_timestamps_LGA09','inactive_timestamps_LGA09']},
    'LGA10':{'order':17,'date': 'long_access_start_date', 'items':['reward_presses_LGA10','active_lever_presses_LGA10','timeout_presses_LGA10','inactive_lever_presses_LGA10','reward_timestamps_LGA10','active_timestamps_LGA10','timeout_timestamps_LGA10','inactive_timestamps_LGA10']},
    'LGA11':{'order':18,'date': 'long_access_start_date', 'items':['reward_presses_LGA11','active_lever_presses_LGA11','timeout_presses_LGA11','inactive_lever_presses_LGA11','reward_timestamps_LGA11','active_timestamps_LGA11','timeout_timestamps_LGA11','inactive_timestamps_LGA11']},
    'LGA12':{'order':19,'date': 'long_access_start_date', 'items':['reward_presses_LGA12','active_lever_presses_LGA12','timeout_presses_LGA12','inactive_lever_presses_LGA12','reward_timestamps_LGA12','active_timestamps_LGA12','timeout_timestamps_LGA12','inactive_timestamps_LGA12']},
    'LGA13':{'order':20,'date': 'long_access_start_date', 'items':['reward_presses_LGA13','active_lever_presses_LGA13','timeout_presses_LGA13','inactive_lever_presses_LGA13','reward_timestamps_LGA13','active_timestamps_LGA13','timeout_timestamps_LGA13','inactive_timestamps_LGA13']},
    'LGA14':{'order':21,'date': 'long_access_start_date', 'items':['reward_presses_LGA14','active_lever_presses_LGA14','timeout_presses_LGA14','inactive_lever_presses_LGA14','reward_timestamps_LGA14','active_timestamps_LGA14','timeout_timestamps_LGA14','inactive_timestamps_LGA14']},
    'LGA15':{'order':21,'date': 'lga_15_date', 'items':['reward_presses_LGA15','active_lever_presses_LGA15','timeout_presses_LGA15','inactive_lever_presses_LGA15','reward_timestamps_LGA15','active_timestamps_LGA15','timeout_timestamps_LGA15','inactive_timestamps_LGA15']},
    'LGA16':{'order':21,'date': 'lga_16_date', 'items':['reward_presses_LGA16','active_lever_presses_LGA16','timeout_presses_LGA16','inactive_lever_presses_LGA16','reward_timestamps_LGA16','active_timestamps_LGA16','timeout_timestamps_LGA16','inactive_timestamps_LGA16']},
    'LGA17':{'order':21,'date': 'lga_17_date', 'items':['reward_presses_LGA17','active_lever_presses_LGA17','timeout_presses_LGA17','inactive_lever_presses_LGA17','reward_timestamps_LGA17','active_timestamps_LGA17','timeout_timestamps_LGA17','inactive_timestamps_LGA17']},
    'LGA18':{'order':21,'date': 'lga_18_date', 'items':['reward_presses_LGA18','active_lever_presses_LGA18','timeout_presses_LGA18','inactive_lever_presses_LGA18','reward_timestamps_LGA18','active_timestamps_LGA18','timeout_timestamps_LGA18','inactive_timestamps_LGA18']},
    'LGA19':{'order':21,'date': 'lga_19_date', 'items':['reward_presses_LGA14','active_lever_presses_LGA14','timeout_presses_LGA14','inactive_lever_presses_LGA19','reward_timestamps_LGA19','active_timestamps_LGA19','timeout_timestamps_LGA19','inactive_timestamps_LGA19']},
    'LGA20':{'order':21,'date': 'lga_20_date', 'items':['reward_presses_LGA20','active_lever_presses_LGA20','timeout_presses_LGA20','inactive_lever_presses_LGA20','reward_timestamps_LGA20','active_timestamps_LGA20','timeout_timestamps_LGA20','inactive_timestamps_LGA20']},
    'Von Frey 2':{'order':22,'date': 'von_frey_2_date', 'items':['von_frey_2_force','von_frey_2_time','vf2_right_force_1','vf2_right_time_1','vf2_left_force_1','vf2_left_time_1','vf2_right_force_2','vf2_right_time_2','vf2_left_force_2','vf2_left_time_2','vf2_right_force_3','vf2_right_time_3','vf2_left_force_3','vf2_left_time_3','vf2_right_force_avg','vf2_right_time_avg','vf2_left_force_avg','vf2_left_time_avg']},
    'Tail Immersion 3':{'order':23,'date': 'tail_immersion_3_date', 'items':['tail_immersion_3_time',]},
    'PR02': {'order':24,'date':'progressive_ratio_2_date' , 'items':['reward_presses_PR02','active_lever_presses_PR02','inactive_lever_presses_PR02','breakpoint_PR02','last_ratio_PR02','ratios_PR02']},
    'TREATMENT01': {'order':25,'date':'treatment_1_date', 'items':['reward_presses_TREATMENT01','active_lever_presses_TREATMENT01','inactive_lever_presses_TREATMENT01','breakpoint_TREATMENT01','ratios_TREATMENT01']},
    'TREATMENT02': {'order':26,'date':'treatment_2_date', 'items':['reward_presses_TREATMENT02','active_lever_presses_TREATMENT02','inactive_lever_presses_TREATMENT02','breakpoint_TREATMENT02','ratios_TREATMENT02']},
    'TREATMENT03': {'order':27,'date':'treatment_3_date', 'items':['reward_presses_TREATMENT03','active_lever_presses_TREATMENT03','inactive_lever_presses_TREATMENT03','breakpoint_TREATMENT03','ratios_TREATMENT03']},
    'TREATMENT04': {'order':28,'date':'treatment_4_date', 'items':['reward_presses_TREATMENT04','active_lever_presses_TREATMENT04','inactive_lever_presses_TREATMENT04','breakpoint_TREATMENT04','ratios_TREATMENT04']},
}

# COMMAND ----------

def remove_after_last_good_session(row):
    
    def date_gen(row, date_name, trial):
        if 'long_access' in date_name or 'short_access' in date_name:
            temp_date = pd.to_datetime(row[date_name])
            temp_date += datetime.timedelta(days=int(trial[-2:]) )
            return temp_date
        else:
            return pd.to_datetime(row[date_name])
    if type(row['last_good_session']) != str :
        return row
    orders = orders_coc
    if row['drug_group'] == 'Oxycodone':
        orders = orders_oxy
    if row['last_good_session'].upper() not in orders:
        return row
    last = orders[row['last_good_session'].upper()]
    for trial in orders_coc:
        o = orders_coc[trial]
        if type(row[o['date']]) == str and type(row[last['date']]) == str:
            if date_gen(row,o['date'],trial) > date_gen(row,last['date'],row['last_good_session']):
                for i in o['items']:
                    row[i] = np.nan
        else:
            if o['order'] > last['order']:
                for i in o['items']:
                    row[i] = np.nan
    return row

# COMMAND ----------

test = test[ordered_cols]
test = test.apply(remove_after_last_good_session, axis=1)
test = test[ordered_cols]

test.to_csv(os.path.join('/dbfs/mnt/testmount/combined_table/database_combined.csv'), index=False)